var ARRtitle,PREVtitle,RAWtune,BARSperLine,IRB,NOTEset,NOTEtrivia,NOTEtech,NOTElinks,TOPlast,SCROLLbase,SCROLLpix,PAGEht,TABwt,TIMEOUTblink,TIMEOUTcrap,TIMEOUTdelay,TIMEOUTfade,TIMEOUTnext,TIMEOUTscroll,TIMEOUTmirror,TIMEOUTmet,TIMEOUTwait,ARRsongSettings,WINDht,WINDwt,MET,METRObpm,METRObeats,BARShalf,TEMPO,BACKTRACK,CHORDfont,REV="Beta 7-1",JSname="NextPlayerX.js",ALT=!1,AUDfail=!1,AUDend=!1,BOOT=!0,NASH=!1,SETnoteViewed=!1,ARRsoundModes="SILENT/nBACK TRACK/nCLICK TRACK/nDRUM ROCK/nDRUM COUNTRY".split("/n"),DUR=120,DURsource="Default",DURcalc=0,DURmp3=0,KEYlast="C",KEYbase="X",LINElimit=90,LONGLINE=50,MIRROR=0,TRANSPOSE=0,SOUNDmodeDefault="SILENT",SOUNDmode="SILENT",SOUNDicon="transSilent.png",TUNEnum=0,TUNElast=0,VOLdefault=.5,VOL=null,WARNING="No Warnings!",SONGsource="select",ARTIST="Unknown",ARRlines="",BARS=0,BEATS=4,BPMfile=10,BPM=100,DURtext=0,GENRE="Unknown",HITyear="Unknown",KEY="C",MEASURES=0,QUAL="Raw",STARS=1,STYLE="Unknown",TITLE="Unknown",TITLEplus="Unknown",SS=0,FONTSIZE=2.5,CHORDlines=0,PRESONGlines=0,SCROLLkon=.01,POStrack=0,POSscreen=0,SCROLLstartTime=0,Ypos=0,Ystart=0,ARRpresets="CAPS,FULLscreen,LEFTborder,CLOCK,TEXT,SHADE,NOTES,SETnotes,POPnotes,TECHnotes,LIVEnotes,COUNTin,BREAKlines,BIGchords,LOOPER,METRO,BARsync".split(","),BACKdrop=!1,BARsync=!1,BIGchords=!0,BIGchordSize=1,BREAKlines=!0,COUNTin=!1,CAPS=!0,CLOCK=!1,CLOCKstart=0,CLOCKstop=0,ENDpause=!1,FULLscreen=!1,LEFTborder=!1,LINEnum=!1,LINEtime=!1,LINKnotes=!1,LIVEnotes=!1,NOTES=!1,POPnotes=!1,SHADE=!1,SOUND=!0,SETnotes=!1,TEXT=!1,TRIVIAnotes=!1,TECHnotes=!1,ARRscale="A,Bb,B,C,C#,D,Eb,E,F,F#,G,Ab,A,Bb,B,C,C#,D,Eb,E,F,F#,G,Ab,A,Bb,B,C,C#,D,Eb,E,F,F#,G,Ab".split(","),MSGlast="No Message...",RAT=.7,PLAYlist="X",SETname="Single Tune",METRO=!1,LOOPER=!1,LOOPon=!1,LOOPtop=0,LOOPtopBU=0,LOOPend=1e5,LOOPendBU=1e5,LOOPmode="repeated",ENDscroll=!1,ENDaudio=!1,ARRtf="true,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false".split(","),PRESETno=0,PRESET="Default Mode",PRESETlock=!1,BAR=0,BARalign=0,BARSTOP=0,ARRbars="".split(","),ARRpx="".split(","),LOG=640,ARRstatusLog="<pre><X2>=================DEBUG LOG=================</x2></pre>".split("@"),STATUSmode=1,TEMPOstart=0,TEMPOcount=0,TEMPOtime=0,TEMPOtimeLast=0,MAP="".split(","),MAPoffset=0,LOCALkey="TBD",LOCALvalue="TBD",SHIT=!1,MAXchordFont=5,MINchordFont=1,MAXbars=0,BARchr=1;function loadLocal(e){dis("localAction","block"),refreshLocal()}function deleteLocal(){statusMsg("Deleted "+document.getElementById("keyLocal").value,0),localStorage.removeItem(document.getElementById("keyLocal").value),statusMsg("Deleted Local Storage: "+LOCALkey,0),refreshLocal()}function refreshLocal(e){dis("localAction","block");var t="";for(i=0;i<localStorage.length;i++)t=t+"<option>"+localStorage.key(i)+"</option>";t+="</select>",document.getElementById("selectLocal").innerHTML=t,document.getElementById("selectLocal").selectedIndex=e,LOCALkey=document.getElementById("selectLocal").value,document.getElementById("keyLocal").value=LOCALkey,LOCALvalue=localStorage.getItem(LOCALkey),document.getElementById("keyLocal").value=LOCALkey,document.getElementById("valueLocal").value=LOCALvalue,document.getElementById("localAction").style.backgroundColor="lightgrey"}function saveLocal(){var e=document.getElementById("valueLocal").value;localStorage.setItem(document.getElementById("keyLocal").value,e),statusMsg("Saved Local Storage: "+LOCALkey,0),document.getElementById("localAction").style.backgroundColor="lightgrey",refreshLocal()}function dateLocal(){var e=new Date;document.getElementById("localAction").style.backgroundColor="pink",document.getElementById("valueLocal").value=e}function newLocal(){new Date;document.getElementById("localAction").style.backgroundColor="pink",document.getElementById("valueLocal").value="????",document.getElementById("keyLocal").value="????"}function listLocal(){var e="";for(i=0;i<localStorage.length;i++)e=e+parseInt(i+1,10)+": "+localStorage.key(i)+" / "+localStorage.getItem(localStorage.key(i))+"<br>";document.getElementById("cloudTitle").innerHTML="LOCAL STORAGE LIST:",document.getElementById("cloudX").innerHTML=e,dis("cloud","block")}function mailTo(e){var t,n="",o="";msg="Accessing mailer...","open"==e?(o=localStorage.getItem("mail"),document.getElementById("mailerBody").value=o,dis("mailer","block"),msg="Mailer opened..."):"save"==e?null==(o=document.getElementById("mailerBody").value)||""==o||null==o||o.length<=2?(alert("Mail is blank, Cannot save that..."),document.getElementById("mailerBody").value="",localStorage.setItem("mail",""),msg("Cant save empty draft of mail...")):(document.getElementById("msg").style.width="96%",localStorage.setItem("mail",o),msg="Mail Draft saved..."):"close"==e?(dis("mailer","none"),msg="Mail closed..."):"title"==e?n=TITLE+":":"info"==e?(t=document.getElementById("Tune").scrollTop/SCROLLpix,o=parseInt(t*DUR,10),n=TITLE+": ["+o+" seconds {"+parseInt(100*t,10)+"%}]  ("+SETname+")"):"key"==e?n=TITLE+": Key(Base)="+KEYbase+": now ="+KEY:"tempo"==e?n=TITLE+": Tempo now "+BPM:"set"==e?n=TITLE+": Set="+SETname:"hilite"==e?n=TITLE+":\nSelected Text----------------------------------\n"+getSelectionText()+"\n----------------------------------------------":"restore"==e?n=localStorage.getItem("sentMail"):"delete"==e?!0===confirm("PERMANENTLY delete Your eMail draft")?(document.getElementById("mailerBody").value="",localStorage.setItem("mail",""),msg="eMail Deleted.",document.getElementById("msg").style.width="100%"):msg="eMail retained.":"send"==e&&(localStorage.setItem("sentMail",document.getElementById("mailerBody").value),window.open("mailto:fkaparich@gmail.com?subject=From PERFORMER MAIL&body=.............Start of Mail..................%0A"+localStorage.getItem("mail").replace(/\n/g,"%0A")+"..................End of Mail.................."),localStorage.setItem("mail",""),document.getElementById("mailerBody").value="",dis("mailer","none"),document.getElementById("msg").style.width="100%",msg="SEND THE MAIL (Mailer has been cleared!)"),""!=n&&(localStorage.setItem("mail",localStorage.getItem("mail")+n+"\n"),document.getElementById("mailerBody").value=localStorage.getItem("mail"),msg="Email: "+e),statusMsg(msg,"yellow")}function getSelectionText(){var e="";return window.getSelection?e=window.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(e=document.selection.createRange().text),e}function rTrim(e){for(;" "==e.substring(e.length-1);)e=e.substring(0,e.length-1);return e}function iconize(e,t){return""==e|null==e&&(e="transRedCircle"),""==t|null==t&&(t=FONTSIZE),"<img src='../../Icons/"+e+".png' alt ='?' style='position:absolute;width:"+FONTSIZE+"'>"}function localFile(e,t,n){var o="<!DOCTYPE html><head></head><body>",l=window.open("","","toolbar=yes, location=yes, directories=no, status=no, menubar=yes, scrollbars=yes, resizable=no, copyhistory=yes, width="+parseInt(WINDwt/2,10)+", height="+parseInt(WINDht/3,10));o=(o="<!DOCTYPE html><head></head><body><b>"+e+"</b>")+"<br><br><a href='"+n+"'>INTERNET LINK (Click Here...)</a>",o=(o+="<br><br>To View the Local File, (If it is on your on YOUR Machine)...<br>--PASTE the string below into Address Bar...")+"<br>--<a href='"+t+"'>"+t+"<br>",o+="</body></html>",l.document.write(o),l.document.close}function btInst(){alert("BACKTRACK INSTRUCTIONS\n1) Select a song in with Backtrack in 'Backtrack Mode'...\n2) The Default measurement is automatic...\n3) Analyize the 'Map' and look at the Quality (Color Coded: Excellent,Good,Marginal,Sucks) \n4) Verify average Tempo in C by Taking 3 measurements of Tempo (start,middle,end) and make sure it is logged correcly\n5) Put your best measurement in the yellow input box and re-evaluate\n6) To Get an acceptable reading change the length of the MP3 or put the correct number of bars in the song text\n7) Be sure to add any intro bars to the start of the song and the correct number of hold bars at the end ")}function btAnal(){var e=document.getElementById("btMdur").innerHTML-MEASURES*BEATS*60/document.getElementById("btTempo").value,t=document.getElementById("btMdur").innerHTML*document.getElementById("btTempo").value/(60*BEATS),n="<pre>Measured tempo and backtrack duration indicate:"+t+" MEASURES\n=================\n";n=n+"Your file has "+MEASURES+" MEASURES\n=================\n"+"MP3 duration is off by "+e+" seconds\n=================\n"+"OR by "+parseFloat(MEASURES-t,10)+" Measures</pre>",document.getElementById("eval").innerHTML=n}function d(e){return document.getElementById(e)}function songMap(){countBARS(),d("map").innerHTML="<pre>"+MAP.join("-")+"</pre>";parseFloat(0/BAR,10),parseFloat(0/BAR,10);var e,t="white",n="black",o="None";d("btTitle").innerHTML=TITLE,d("btFbpm").innerHTML=BPMfile,d("btFbars").innerHTML=BARS,d("btFmeas").innerHTML=MEASURES,d("btFdur").innerHTML=MEASURES*BEATS*60/BPMfile,d("btMbpm").innerHTML=BEATS*MEASURES*60/Audio1.duration,d("btMmeas").innerHTML=MEASURES,d("btMdur").innerHTML=Audio1.duration,d("btTdur").innerHTML=Audio1.duration,d("btTmeas").innerHTML=d("btTempo").value*Audio1.duration/(60*BEATS),d("btRbpm").innerHTML=d("btMbpm").innerHTML-d("btTempo").value,d("btRmeas").innerHTML=d("btMmeas").innerHTML-d("btTmeas").innerHTML,d("btRdur").innerHTML=MEASURES*BEATS*60/BPMfile-Audio1.duration,o=(o=(e=Math.abs(d("btRmeas").innerHTML))<=.5/BEATS?(n="gold",t="black","Excellent: "):e<=1/BEATS?(n="green","Good: "):e<=2/BEATS?(n="yellow",t="black","Marginal: "):(n="red","Timing Sucks: "))+" Off by "+parseInt(e*BEATS*1e3,10)/1e3+" beats over the Entire Song",d("trackQual").style.backgroundColor=n,d("trackQual").style.color=t,d("trackQual").innerHTML=o}function monitorBoot(){clearTimeout(TIMEOUTcrap),statusMonitor(2),statusMsg("Debug Mode; Initiated by User"),start()}function start(){var e;statusMsg("Initiating Javascript..."),j=0,clearTimeout(TIMEOUTcrap),document.getElementById("dubugSafety").focus(),document.getElementById("revStatus").innerHTML="REV: "+REV;for(var t="<a style='text-align:center; width:100%'><a style='color:white;'>SOUND MODE</a><br><select id='soundSelector' style='background-color:white;color:black;font-size:2vw; width:100%' onchange='setSoundModeDefault(this.value)'>";j<ARRsoundModes.length;)t=t+"\n<option>"+ARRsoundModes[j]+"</option>",j++;t+="\n</Select>",document.getElementById("soundBox").innerHTML=t,void 0===(e=receiveARR())|null===e|""===e|e.length<10?(BOOT=!0,statusMsg("No valid array passed to boot routine",0),createSetSelector()):(statusMsg("Song Recieved from the editor",0),BOOT="edit",ARRtitle="Passed From Editor".split(","),createARRlines(e))}function createSetSelector(){statusMsg("Creating Set Selector...");var e=getTextFile("SetList.txt").split("\n"),t="<a style='text-align:center; width:45vw;color:white'>PLAYLIST:</a><br><select id='Set' style='font-size:2vw' onchange='SETname=(this.value);selectPlaylist(this.value)'><option selected>ALL TUNES</option>";for(j=0;j<e.length;)"ALL TUNES"!=e[j].substr(0,9)&&(t=t+"\n<option>"+e[j]+"</option>"),j+=1;t+="\n</Select>",document.getElementById("setSelectA").innerHTML=t,selectPlaylist("ALL TUNES")}function selectPlaylist(e){statusMsg("Selecting Playlist "+e,0);var t=getTextFile("../Sets/"+e+".txt");SETname=e,PLAYlist="",PLAYlist=t.split("\n"),dis("abet","ALL TUNES"==e?"block":"none"),TUNEnum=0,createPlayListSelector()}function createPlayListSelector(){var e;statusMsg("Creating PlayList Selectors "+SETname,0),statusMsg("Formating Small Playlist and Selecting Default Song...","yellow");var t="";for(j=0;j<PLAYlist.length;)"@"==(e=PLAYlist[j].split("|")[0]).substring(0,1)&&(e=e.substring(1,e.length)),t=t+"\n<option value= '"+PLAYlist[j]+"'>"+e+"</option>",j++;t+="\n",document.getElementById("mySet").innerHTML=t,document.getElementById("mySet").selectedValue=TUNEnum,TITLEplus=PLAYlist[TUNEnum],selectTune(PREVtitle=TITLEplus)}function selectTuneNo(e){statusMsg("Selecting tune by number: "+e),e<0||e>=PLAYlist.length?statusMsg("No Tune","red"):(document.getElementById("mySet").selectedIndex=e,selectTune(PLAYlist[e]))}function openSong(){statusMsg("Request Tune by exact Title... ",0),SONGsource="request",dis("nextIcon","none"),dis("nextIcon","none"),selectTune(prompt("Please type the exact tune name",TITLE))}function selectTune(e){"@"!==(ARRtitle=(TITLEplus=e).split("|"))[0].substr(0,1)?(TITLE=ARRtitle[0],ALT=!1):(ALT=!0,TITLE=ARRtitle[0].substr(1)),statusMsg("Selected: "+(TITLE=TITLE.replace(/(\r\n|\n|\r)/gm,""))),TUNEnum=PLAYlist.indexOf(TITLEplus),dis("backtracker","none"),document.getElementById("mySet").selectedIndex=TUNEnum,document.getElementById("myTune").innerHTML=TITLE,CTO(),document.getElementById("content").innerHTML="",SOUNDmode=void 0!==ARRtitle[3]&""!==ARRtitle[3]?ARRtitle[3]:SOUNDmodeDefault,void 0!==ARRtitle[4]&""!==ARRtitle[4]&&(NOTEset=ARRtitle[4]),VOL=void 0!==ARRtitle[5]&""!==ARRtitle[5]?ARRtitle[5]:VOLdefault,1!=PRESETlock&&loadServerTitle()}function loadServerTitle(){statusMsg("Loading Song by"+TITLE),KEYbase="X",document.getElementById("key2").innerHTML="-",document.getElementById("title").innerHTML=TITLE,TRANSPOSE=0,CTO(),ARRlines="",screenFormat("Think","transArrowDown.png");var e=getTextFile("../Text/"+TITLE+".txt"),t=e.search("404");if(0<t){if("NOTE"==TITLE){for(arr=TITLEplus.split("|"),e="<div style='text-align:left;color:black;'><br><br><br>NOTES: "+SETname+"<br>========================",t=1;t<arr.length;t++)e=e+"<br> "+t+") "+arr[t];e+="</div>",document.getElementById("content").innerHTML=e}else e="<!DOCTYPE html><head>NO FILE</head><body><center><X2><br><br>Request Denied<br>NO FILE TITLED<br>'"+TITLE+"'<br>404 ERROR returned by Server</X2></center></body></html>",statusMsg("Request for "+TITLE+" Denied!...",0);DUR=5,DURsource="MP3",document.getElementById("Audio1").src="../Backing/Sound A.mp3",document.getElementById("content").innerHTML=e,statusMsg("Song Unavailable...Printing Note or 404",0),scrollSetup()}else 1!=PRESETlock&&(BACKTRACK=TITLE,createARRlines(e))}function createARRlines(e){for(statusMsg("Processing Song file: "+TITLE),NOTEset=void 0,ARRlines="";0<=e.indexOf("\r");)e=e.replace("\r","");ARRlines=e.split("\n"),firstLineValues(),KEYlast=KEY,"X"==KEYbase&&(KEYbase=KEY),NASH=!1,"edit"!==BOOT&&(void 0!==ARRtitle[1]&""!==ARRtitle[1]&&newKey(ARRtitle[1]),void 0!==ARRtitle[2]&""!==ARRtitle[2]&&(BPMfile=BPM=ARRtitle[2]),void 0!==ARRtitle[3]&""!==ARRtitle[3]&&(SOUNDmode=ARRtitle[3]),void 0!==ARRtitle[4]&""!==ARRtitle[4]&&(NOTEset=ARRtitle[4])),loadServerTrack()}function loadServerTrack(){rollMirror(!1);var e="",t=SOUNDicon="transSilent.png";document.getElementById("mirror").style.color="transparent",document.getElementById("mirrorImage").src="../../Icons/"+SOUNDicon,document.getElementById("Audio1").style.display="none";var n=BPM;if("SILENT"==SOUNDmode)statusMsg(SOUNDmode+": "+parseInt(1,10)+" sec delay...",0),document.getElementById("mirrorImage").src=document.getElementById("buttonTrack2").src="../../Icons/transSilent.png",t="transSilent.png",document.getElementById("Audio1").src="",durCalc();else{if(statusMsg("Loading "+SOUNDmode+" track with "+parseInt(1,10)+" sec delay..."),"BACK TRACK"==SOUNDmode)BPMfile=BPM=hash(ARRlines[0],"BPM",BPM),t="transBackTrack.png",e="../Backing/"+BACKTRACK+".mp3",document.getElementById("trackName").innerHTML=BACKTRACK+".mp3";else{for(;parseFloat(n/5,10)!==parseInt(n/5,10);)n=parseInt(n,10)+1;if(BPM=n,"CLICK TRACK"==SOUNDmode&&(t="transClick.png",e="../Click/"+BPM+".mp3"),2!=BEATS&4!=BEATS&8!=BEATS&16!=BEATS&"none.png"==t)return t="transTrackNo.png",document.getElementById("buttonTrack2").src="../../Icons/transTrackNo.png",AUDfail=!0,void durCalc();"DRUM ROCK"==SOUNDmode?(t="transRock.png",e="../DrumRock/"+BPM+".mp3"):"DRUM COUNTRY"==SOUNDmode&&(t="transCountry.png",e="../DrumCountry/"+BPM+".mp3")}screenFormat("Think",SOUNDicon=t),document.getElementById("Audio1").src=e,Audio1.preload="auto";var o=setTimeout(function(){clearTimeout(o),statusMsg("MP3 Duration:"+(DURmp3=document.getElementById("Audio1").duration),0),!0===SOUND&&(document.getElementById("Audio1").volume=VOL,document.getElementById("V").innerHTML=parseInt(100*VOL,10)+"%"),!1===isNaN(DURmp3)?(document.getElementById("Audio1").style.visibility="visible",AUDfail=!1):(AUDfail=!(DURmp3=0),SOUNDicon="transTrackNo.png",statusMsg("Sound Track Failed...",0)),document.getElementById("mirrorImage").src=document.getElementById("buttonTrack2").src="../../Icons/"+SOUNDicon,durCalc()},1e3)}}function durCalc(){statusMsg("Determining Song Duration...BPM>"+BPM,"yellow"),DURmp3=DURcalc=0,DUR=150,countBARS(),DURsource="Est",0<isNaN(DURtext)&&(DUR=DURtext,DURsource="File"),5<MEASURES&1<=BEATS&20<BPM&&(1<(DURcalc=parseInt(MEASURES*BEATS*60/BPM,10))&&(DURsource="Calc: "+BPM+"bpm@"+BARS+"Bars",DUR=DURcalc),"BACK TRACK"===SOUNDmode&20<document.getElementById("Audio1").duration&&(DURmp3=Audio1.duration,BPM=BARS*BEATS*60/(DUR=DURmp3),DURsource="MP3")),DUR=parseInt(DUR,10),1!=PRESETlock&&(statusMsg("Array Conversion Triggered by Duration Calculation",0),arrConvert())}function arrConvert(){statusMsg("Converting Array to HTML using custom settings..."),CTO();var e,t,n,o,l,s,r,i,a,d,c,u=!(WARNING="No Warnings!"),m="",E=lyricLineCount(),g=0,T=!0;NOTEtrivia="NO TRIVIA NOTES",IRB=NOTElinks=NOTEtech=void(PRESONGlines=0),screenFormat("Think","danger.png"),1==(LONGLINE=longestLine()+1)&&(LONGLINE=74,u=!0),LONGLINE=LINElimit,!0===LINEnum|!0===LINEtime&&(LONGLINE+=4);var I=1;fsize=!0===TEXT?(A="/Small Text",165/LONGLINE):180/LONGLINE,S=fsize.toString(),FONTSIZE=S.substring(0,4)+"vw",e=(S=(BIGchordSize*fsize).toString()).substring(0,4)+"vw";var R;for(statusMsg("#) Type/Action================================",barCount=0);g<ARRlines.length;){if(A=g+") "+(n=lineType(t=rTrim(ARRlines[g]))),"irealb"==n)IRB=t,A+=" hidden",t=t=void 0;else if("hash"==n)t=void 0;else if("noteLive"==n)t=0==LIVEnotes?void 0:t.substring(2,t.length);else if("noteTriv"==n)"NO TRIVIA NOTES"==NOTEtrivia&&(NOTEtrivia=""),NOTEtrivia=NOTEtrivia+t.substr(2)+"<br>",t=void 0;else if("tab"==n)alert(TITLE+" file line "+g+" contains a tab, It should be removed");else if("noteTech"==n)NOTEtech=void 0===NOTEtech?t.substr(3):NOTEtech+"\n"+t.substr(3),t=void 0;else if("link"==n)void 0===NOTElinks&&(NOTElinks=""),o=t.split("|"),NOTElinks=NOTElinks+"<u><a onclick =window.open('"+o[0]+"')>"+o[1]+"</a></u><br>",t=void 0;else if("note"==n)t=!0!==NOTES?void 0:iconize("transRedCircle")+"  <X1>"+t.substr(1,t.length)+"</X1>";else if("chord"==n){if(A="<x2>"+A,T=!1,0!==TRANSPOSE)t=lineTranspose(t,TRANSPOSE),A=A+"/Transpose("+TRANSPOSE+")";else if(!0===BIGchords)for(A=A+"/Big Chords("+100*BIGchordSize+"%)",(s=(t=t.replace(/\s+/g,"")).split("|")).splice(0,1),R=BARSperLine,r=parseInt(LONGLINE/(R*BIGchordSize),10)-1,t="",S=0,s.length>R&&(r=parseInt(r*R/s.length,10));S<s.length;){for(l=s[S];l.length<=r;)l=l.replace(/~/g," ~"),l+=" ";t=t+"|"+l,S+=1}if(!0===BARsync){A+="/BarSync(";for(var p="",S=0,L=!0;S<t.length;)"|"==t[S]?(!0===L?(p=p+"<a id='b"+barCount+'\' style="backgroundColor:transparent;">|',L=!1):p=p+"</a><a id='b"+barCount+'\' style="backgroundColor:transparent;">|',barCount++):p+=t[S],S++;for(;p.length<LONGLINE;)p+=" ";t=p+="               </a>",A=A+barCount+" Bars)</X2>"}!0===LIVEnotes&&(t=(t=t.replace(/#-->/g,"</X16>")).replace(/<!--#/g,"<X16>")),t="<X100>"+t+"</X100>"}else if("header"==n){for(A="<X8>"+A+"========================================</X8>",t=(t=t.replace(/-/g,"=")).substring(1,t.length);t.length<LONGLINE-5;)t+="=";!0!==LINEnum&&!0!==LINEtime||(t="<X6>    </X6>"+t),t="<X8>"+t+"</X8>"}else if("lyric"==n){var A="<X1>"+A;g+1<ARRlines.length&&(lineType(c=ARRlines[g+1]),"lyric"===lineType(c)&&(t+=c,g+=1)),t.length>LONGLINE&&(t.length>parseInt(2*LONGLINE,10)-5&&(WARNING="LYRIC LINES TOO LONG FOR SELECTED FONT >>> COMPLETE LINES MAY NOT BE DISPLAYED"),t=breakLine(t),A+="/Split"),!0===CAPS&&(t=t.toUpperCase(),A+="/Capitalized"),!0===LINEnum&&(t=(I<10?"<X5>"+I+"   </X5>":I<100?"<X5>"+I+"  </X5>":NaN+I+" </X5>")+t,I++),!0===LINEtime&&(t="<X5>"+secToMin((I-1)/E*DUR,10)+"</X5>"+t,I++),!0===LINEnum&&(t=(I<10?"<X5>"+I+"   </X5>":I<100?"<X5>"+I+"  </X5>":NaN+I+" </X5>")+t,I++),!0===LIVEnotes&&(t=(t=(t=t.replace(/XX>/g,"X16>")).replace(/#-->/g,"</X16>")).replace(/<!--#/g,"<X16>")),A+="</X1>"}else if("spacer"==n){for(t="."+t.substring(1,t.length);t.length<LONGLINE;)t+=" ";t="<X7>"+t+"</X7>",!0!==LINEnum&&!0!==LINEtime||(t="<X6>    </X6>"+t)}t&&(!0===LEFTborder&&(t="  "+t,A+="/Left-Space"),m=m+t+"\n"),!0===T&null!=t&&(PRESONGlines++,A+="/preSong"),statusMsg(A,0),g++}for(WINDht=window.innerHeight,WINDwt=window.innerWidth,RAT=parseFloat(WINDht/WINDwt),i=parseInt(100/fsize*RAT,10),a=parseInt(i/2-PRESONGlines,10),d="",g=0,d="<br><X4><center>"+TITLE.toUpperCase()+"</center></X4><br>";g<=a-3;)d+="<br>",g++;for(!0===u&&(m=m+"<img src='../Img/"+TITLE+".jpg' width='"+.98*WINDwt+"px'>"),m="<!DOCTYPE html><html><head><title id='title'>"+TITLE+"</title><style>\nBody{font-size : "+FONTSIZE+"; color:black; margin :0vh; padding: 0; font-family:Courrier New;font-weight:bold;line-height:100%;text-align:left;background-color:transparent;}"+"\nX99{color:red;font-size:"+e+";line-height:100%;}\n"+"\nX100{color:red;font-size:"+e+";line-height:100%;}\n</style></head><body>"+"<pre>"+d+m,offset2="",g=1;g<parseInt(i/2,10);)offset2+="<br>",g++;m=m+"<X2><center>=====    END    =====</center></X2><br>"+offset2+"</pre></body></html>",statusMsg("Line)Type/Actions================================",0),void 0!==NOTEtech&&(NOTEtech="<pre>"+NOTEtech+"</pre>"),opacSet("ButtonTrivia",""===NOTEtrivia|void 0===NOTEtrivia?.2:1),"BACK TRACK"!=SOUNDmode|!0===isNaN(Audio1.duration)?opacSet("ButtonBT",.2):opacSet("ButtonBT",1),opacSet("ButtonTech",""===NOTEtech|void 0===NOTEtech?.2:1),opacSet("ButtonLinks",""===NOTElinks|void 0===NOTElinks?.2:1),opacSet("irbIcon",""===IRB|void 0===IRB?.2:1),document.getElementById("content").innerHTML=m,!1===u?scrollSetup():loadSongImage("../Img/"+TITLE+".jpg")}function loadSongImage(e){statusMsg("Loading Grapic Song Image...");var t=new Image;t.src=e,t.addEventListener("load",function(){scrollSetup()})}function scrollSetup(e){statusMsg("Setting Up Scroll...","red");var t="No Scroll Mesage";statusMsg(t,0),PAGEht=document.getElementById("content").clientHeight,document.getElementById("Tune").scrollTop=0,Ystart=0,Ypos=document.getElementById("Tune").scrollTop,SCROLLpix=parseInt(PAGEht-WINDht,10),!0===isNaN(DUR)&&(msgColor="yellow",DURsource=!1===isNaN(DURcalc)?(DUR=DURcalc,"Bars & Beats"):!1===isNaN(DURtext)?(DUR=DURtext,"From File"):(DUR=150,"Wild Guess"),statusMsg("Audio available","green")),SCROLLbase=SCROLLkon=1e3*DUR/SCROLLpix,document.getElementById("speed2").innerHTML=parseInt(BPM),t=songSum(),statusMsg("Applying User's Screen Configuration...",0),dis("volCtrl","SILENT"!==SOUNDmode||1==METRO?"block":"none"),"Single Tune"==SETname&&(document.getElementById("title").innerHTML=TITLE),"Default"==DURsource&&(color="Yellow"),dis("clock",!0===CLOCK?"block":"none"),void 0!==NOTEset&!1===SETnoteViewed&!0===SETnotes?notePopUp(NOTEset.split("@").join("<br>"),"2vw","black","white","No Playlist Notes","Playlist Notes","Playlist note..."):!0===POPnotes&PREVtitle!==TITLE?notePopUp(triviaNotes(),"2vw","black","yellow","No Trivia Notes...",0,"No Trivia Notes","Trivia Notes"):!0===TECHnotes&PREVtitle!==TITLE&void 0!==NOTEtech&&notePopUp(NOTEtech,"4vw","black","pink","No Tech Notes...",0,"Technical Notes"),PREVtitle=TITLE,TRANSPOSE=0,document.getElementById("key2").innerHTML=KEY,vis("shade",!0===SHADE?"visible":"hidden"),document.getElementById("thinkIcon").src="../../Icons/trans.png",LOOPend=SCROLLpix,document.getElementById("le").innerHTML=parseInt(DUR,10)+"<br>End",LOOPtop=0,document.getElementById("lt").innerHTML="0<br>Top",!0===ALT&&(document.getElementById("altSong").innerHTML=PLAYlist[TUNEnum+1].split("|")[0]),statusMsg("Wrapping up the song load..."),statusMsg("Program Last Used on: "+localStorage.getItem("NPboot"),0);var n=(new Date).toLocaleString();localStorage.setItem("NPboot",n),screenFormat("Ready"),document.getElementById("splash").style.display="none",document.getElementById("msg").style.top="0%",msgColor="yellow",!0===BOOT&&(null!=localStorage.getItem("mail")&&1<localStorage.getItem("mail").length&&(document.getElementById("msg").style.width="96%",statusMsg("Unsent Mail...")),dis("configuration","block"),clockRun(),BOOT=!1,window.innerHeight>=window.innerWidth&&alert("Rotate your device...Landscape works best..."),1===STATUSmode?(t="Select Sound Mode > Select Playlist > Set Configuration...",msgColor="yellow",statusMonitor(0)):2===STATUSmode&&(t="Boot Successful, You're in the Debug mode...",msgColor="red"),"edit"==BOOT&&(t="SONG PASSED FROM THE EDITOR!!!  REMEMBER TO SAVE IT THERE!!!",document.getElementById("myTune").innerHTML="SONG PASSED FROM EDITOR",msgColor="red")),rollMirror(!0),"Complete"!=QUAL&"BACK TRACK"===SOUNDmode&&(WARNING="THE QUALITY OF THE FILE INDICATES IT MAY NOT SYNC TO THE BACK TRACK"),"No Warnings!"!==WARNING&&(t=WARNING,msgColor="red"),METRObeats=BEATS,150<(METRObpm=BPM)&&(METRObeats=2==BEATS||4==BEATS||8==BEATS||10==BEATS||12==BEATS||16==BEATS?(METRObpm=parseInt(BPM/2),parseInt(BEATS/2,10)):6==BEATS?(METRObpm=parseInt(BPM/3),2):(METRObpm=parseInt(BPM/BEATS),1)),MET=parseInt(6e4/METRObpm,10),BAR=-1,BARSTOP=ARRbars[0],ENDaudio=ENDscroll=!1,"NOTE"==TITLE&&(dis("bigButtons","none"),dis("bigPause","none"),dis("bigPlay","none")),"select"!=SONGsource&&(dis("nextIcon","none"),dis("lastIcon","none")),"true"==localStorage.getItem("developer")&&dis("developer",!0),statusMsg(t,msgColor)}function scrollEngine(){var e;clearTimeout(TIMEOUTscroll),!0===ENDscroll?(statusMsg("Scroll ended...",0),endSong()):(Ypos===document.getElementById("Tune").scrollTop?SS++:SS=0,document.getElementById("Audio1").currentTime>=document.getElementById("Audio1").duration|document.getElementById("Audio1").duration<=20&&(ENDaudio=!0,statusMsg("Audio-"+DURmp3+"-"+document.getElementById("Audio1").duration+"-"+document.getElementById("Audio1").duration+" finished or inactive",0)),Ypos=document.getElementById("Tune").scrollTop,!0===BARsync&&(Ypos<=1&&(document.getElementById("b0").style.backgroundColor="yellow"),BARSTOP<Ypos/SCROLLpix*DUR&BAR<ARRbars.length&&(statusMsg("<X1>BAR:"+BAR+" ended ("+BARSTOP+" sec of "+DUR+" sec)</X1>",0),(BAR+=1)===ARRbars.length?ENDscroll=!0:(BARSTOP=ARRbars[BAR]/MEASURES*DUR,document.getElementById("b"+BAR).style.backgroundColor="yellow",document.getElementById("b"+parseInt(BAR-1,10)).style.backgroundColor="transparent"),document.getElementById("b"+parseInt(BAR-1,10)).style.backgroundColor="transparent")),5<SS|document.getElementById("Tune").scrollTop>LOOPend-1?(ENDscroll=!0,statusMsg("Scroll Complete",0)):!0===LOOPER&&(!0===LOOPon?document.getElementById("Tune").scrollTop>=LOOPend&&(statusMsg("LOOP END...",0),resetLoop()):(LOOPend=SCROLLpix,ENDscroll=!1,statusMsg("LOOP ignored...",LOOPtop=0))),nowTime=(new Date).getTime(),e=parseInt((nowTime-SCROLLstartTime)/SCROLLkon+Ystart,10),document.getElementById("Tune").scrollTop=e,statusMsg("> "+parseInt(Ypos,10)+" px: "+SS,0),TIMEOUTscroll=setTimeout(function(){scrollEngine()},SCROLLkon))}function endSong(){var e,t;clearTimeout("TIMEOUTfade"),!0===BARsync&&barsClear(),!0===LOOPER?!0===LOOPon&&(statusMsg("Calling LOOP Reset at"+document.getElementById("Tune").scrollTop,0),resetLoop()):(CTO(),Audio1.pause(),t=document.getElementById("Audio1").duration,Ypos=document.getElementById("Tune").scrollTop,e=document.getElementById("Audio1").currentTime,statusMsg("Scroll:"+parseInt(100*Ypos/SCROLLpix,10)+"%  Time:"+parseInt(100*e/t,10)+"%",0),1==ENDpause&"SILENT"==SOUNDmode?(t=WINDht/SCROLLkon*500,statusMsg("Pause for scroll catchup...","none"),screenFormat("Think","trans.png"),dis("msg","none"),TIMEOUTcrap=setTimeout(function(){screenFormat("End"),statusMsg("SONG ENDED","yellow")},t)):(screenFormat("End"),statusMsg("SONG ENDED","yellow")))}function printDiv(e){var t=document.getElementById("print").innerHTML,n=document.body.innerHTML;document.body.innerHTML=t,document.body.style.textAlign="left",window.print(),document.body.innerHTML=n}function notePopUp(e,t,n,o,l,s,r){document.getElementById("cloudX").style.color=n,document.getElementById("cloudX").style.backgroundColor=o,document.getElementById("cloudX").style.fontSize=t,document.getElementById("cloudX").innerHTML=e,document.getElementById("cloudX").scrollTop=0,document.getElementById("cloudTitle").innerHTML=s,document.getElementById("cloudX").scrollTop=0,dis("cloud","block"),dis("tool","none"),statusMsg("Pop Up Notes : "+s,0)}function CTO(){statusMsg("Clearing 'TIMEOUTS'",0),clearTimeout(TIMEOUTmet),clearTimeout(TIMEOUTdelay),clearTimeout(TIMEOUTscroll),clearTimeout(TIMEOUTnext),clearTimeout(TIMEOUTfade),clearTimeout(TIMEOUTwait)}function scrollTune(e,t){var n=parseInt(e*WINDht/25,10),o=Math.abs(parseInt(100*e,10)),l=document.getElementById("Tune").scrollTop;void 0===t?(t=1,clearTimeout(TIMEOUTscroll)):t+=1,t<o&0<l?TIMEOUTscroll=setTimeout(function(){document.getElementById("Tune").scrollTop=l+n,scrollTune(e,t)},36):(statusMsg("Scrolled "+parseInt(100*e,10)+"% in "+t+" steps",0),clearTimeout(TIMEOUTscroll),Ystart=document.getElementById("Tune").scrollTop,SCROLLstartTime=(new Date).getTime(),statusMsg("Starting Scroll Engine",0),scrollEngine())}function screenFormat(e,t){statusMsg("Display Format: "+e+"("+t+")",0),"Scroll"==e|"Ready"==e|"Pause"==e|"Think"==e|"End"==e?(clearTimeout(TIMEOUTfade),dis("metronome","none"),dis("Audio1","block"),dis("bigPause","none"),dis("bigButtons","none"),dis("bigPlay","block"),dis("think","none"),dis("backDrop","none"),dis("altSong","none"),dis("msg","none"),dis("lastIcon","block"),dis("nextIcon","block"),"Scroll"==e&&(dis("bigButtons",!1===BARsync?"block":"none"),dis("bigPause","block"),dis("bigPlay","none"),dis("bigReset","none"),barSelect("none"),dis("songIcons","none"),document.getElementById("shade").style.visibility="hidden",!0===BACKdrop&&dis("backDrop","block")),"Ready"===e&&(!0===ALT&&dis("altSong","block"),dis("bigButtons","none"),dis("bigPlay","block"),dis("bigReset","block"),dis("songIcons","block"),dis("msg","block"),dis("Audio1","block")),"End"===e&&(dis("bigButtons","none"),dis("bigPlay","block"),dis("bigReset","block"),dis("songIcons","block"),dis("msg","block"),dis("Audio1","block")),"Pause"===e&&(dis("bigButtons","none"),dis("bigPlay","block"),dis("bigReset","block"),dis("songIcons","block"),dis("Audio1","block"),dis("msg","block")),"Think"===e&&(dis("msg","block"),void 0===t&&(t="trans.png"),document.getElementById("thinkIcon").src="../../Icons/"+t,dis("think","block")),0===TUNEnum&&dis("lastIcon","none"),TUNEnum>PLAYlist.length-2&&dis("nextIcon","none")):alert(e+" is an invalid Command")}function scrollRate(e){BPM<350&e<1|30<BPM&1<e&&(SCROLLkon*=e,statusMsg("Scroll Rate changed from "+BPM+" to "+(BPM/=e),0),showSetting(1),SCROLLstartTime=(new Date).getTime(),Ystart=Ypos,Ypos=document.getElementById("Tune").scrollTop)}function trackPause(){CTO(),!0===BARsync&&barsClear(),document.getElementById("metronome").innerHTML="-","SILENT"!==SOUNDmode&&document.getElementById("Audio1").pause(),!0!==LOOPER|document.getElementById("Tune").scrollTop<LOOPend?statusMsg("Paused...","yellow"):statusMsg("Loop Paused!","yellow"),screenFormat("Pause")}function trackPlay(){Audio1.pause(),ENDscroll=!1,CTO(),clearTimeout(TIMEOUTwait),"SILENT"===SOUNDmode|"BACK TRACK"===SOUNDmode?trackAlign(!1===BARsync?"Screen":"Bar"):"CLICK TRACK"===SOUNDmode|"DRUM COUNTRY"===SOUNDmode|"DRUM ROCK"===SOUNDmode&&trackAlign(!0===BARsync?"Free Bar":"Free"),document.getElementById("Audio1").currentTime=POStrack,Ystart=document.getElementById("Tune").scrollTop=POSscreen,screenFormat("Scroll"),statusMsg("PLAY STEP 2: "+document.getElementById("Audio1").currentTime+" secs >>>"+POStrack,0),SCROLLstartTime=(new Date).getTime(),document.getElementById("Audio1").play(),scrollEngine()}function trackAlign(e){var t;if(Audio1.pause(),POStrack=document.getElementById("Audio1").currentTime,POSscreen=document.getElementById("Tune").scrollTop,msg="Track alignment Error","Screen"===e)POStrack=(t=POSscreen/SCROLLpix)*DURmp3,msg="Aligned to Screen at "+100*t+"%";else if("Audio"===e)t=POStrack/DURmp3,POSscreen=parseFloat(t*SCROLLpix,10),msg="Aligned to Audio at "+100*t+"%";else if("Bar"===e){var n=0;for(i=0;n<document.getElementById("Tune").scrollTop;)n=ARRbars[i]*SCROLLpix/MEASURES,i++;1<i&&--i,BAR=i,BARSTOP=ARRbars[i]/MEASURES*DUR,scrollPos=n,t=document.getElementById("Tune").scrollTop/SCROLLpix,POStrack=parseFloat(t*DUR,10),msg="Aligned to start of BAR "+BAR}else if("Free Bar"===e){n=0;for(i=0;n<document.getElementById("Tune").scrollTop;)n=ARRbars[i]*SCROLLpix/MEASURES,i++;BAR=i,BARSTOP=ARRbars[i]/MEASURES*DUR,t=(POSscreen=n)/SCROLLpix,POStrack=0,msg="Free Start of Audio at BAR "+BAR}else"Free"===e&&(POStrack=0,msg="Free Start of Audio");document.getElementById("Audio1").currentTime=POStrack,document.getElementById("Tune").scrollTop=POSscreen,statusMsg(msg+"<br>\n"+POStrack+"secs @ "+POSscreen+" Pixels",0)}function findBar(){var e=0;for(i=0;e<document.getElementById("Tune").scrollTop;)e=ARRbars[i]*SCROLLpix/MEASURES,i++;document.getElementById("Tune").scrollTop=e,trackAlign("SILENT"===SOUNDmode|"BACK TRACK"===SOUNDmode?"Screen":"Free"),1<i&&--i,BAR=i,BARSTOP=ARRbars[i]/MEASURES*DUR,document.getElementById("b"+BAR).style.backgroundColor="yellow",statusMsg("<X2>findBar()=BAR:"+i+" BARSTOP: "+BARSTOP+"</X2>",0)}function trackReset(){var e;Audio1.pause(),statusMsg("PAUSED"),!1===LOOPER|!1===LOOPon&&(statusMsg("Resetting Song...",0),LOOPtop=0,LOOPend=SCROLLpix,document.getElementById("lt").innerHTML="0<br>Top",document.getElementById("le").innerHTML=parseInt(DUR,10)+"<br>End"),statusMsg("Loop/Track set to "+(document.getElementById("Tune").scrollTop=LOOPtop)+"px"),document.getElementById("Audio1")&&(document.getElementById("Audio1").autoplay=!1,document.getElementById("Audio1").currentTime=LOOPtop*DUR/SCROLLpix),ENDaudio=ENDscroll=!1,!(ALT=!1)===SOUND&&(document.getElementById("Audio1").volume=VOLdefault),!(BAR=0)===BARsync&&barsClear(),CTO(),statusMsg(TITLE+" reset...","yellow"),screenFormat("Ready"),!0===LOOPon&"repeated"===LOOPmode&&(statusMsg((e=document.getElementById("ld").innerHTML.split("<br>")[0])+" second Auto Loop Delay..."),screenFormat("Think","trans.png"),setTimeout(function(){trackPlay()},1e3*e))}function fadeOut(e,t){var n;null==t&&(t=document.getElementById("Audio1").volume/(e*BEATS),e=parseInt(6e4/BPM,10)),n=document.getElementById("Audio1").volume-t,document.getElementById("Audio1").volume=n,clearTimeout(TIMEOUTfade),n<=0?(document.getElementById("Audio1").pause(),ENDaudio=!0,document.getElementById("Audio1").volume=VOL,document.getElementById("V").innerHTML=parseInt(100*VOL,10)+"%",statusMsg("Passing to endSong <X2>Audio Paused and Volume reset to "+100*VOL+"%</X2>",0),endSong()):(document.getElementById("V").innerHTML=parseInt(100*n,10)+"%",TIMEOUTfade=setTimeout(function(){fadeOut(e,t)},e))}function fade(e){var t;!0===SOUND&&(VOL=document.getElementById("Audio1").volume,document.getElementById("V").innerHTML="<X2>"+parseInt(100*VOL,10)+"%</X2>","x"===e&&(e=0<VOL?"down":"up"),"up"==e&VOLdefault<VOL|"down"===e&.01<VOL?TIMEOUTfade=setTimeout(function(){t="down"==e?.7:1.3,0===document.getElementById("Audio1").volume&&(VOL=.005),1<(t*=VOL)&&(t=1),document.getElementById("Audio1").volume=t,fade(e),document.getElementById("V").innerHTML="<X2>Fade</X2>"},1e3):(clearTimeout(TIMEOUTfade),"down"==e&&(document.getElementById("Audio1").volume=0,VOL=0),"up"==e&&(document.getElementById("Audio1").volume=VOL,VOL=VOLdefault),document.getElementById("V").innerHTML="<X2>"+parseInt(100*VOL,10)+"%</X2>"))}function unique(e){for(var t={},n=[],o=e.length,l=0;l<o;++l)t[e[l]]=null;for(l in t)n.push(l);return n}function endLoop(){screenFormat("Ready"),CTO(),statusMsg("Loop Complete...","yellow"),"repeated"==LOOPmode&&(trackPause(),statusMsg(document.getElementById("ld").innerHTML+"second delay..."),TIMEOUTscroll=setTimeout(function(){resetLoop()},1e3*document.getElementById("ld").innerHTML))}function loopMode(){"repeated"==LOOPmode?(LOOPmode="played once",document.getElementById("loopImg").src="../../Icons/transOnePlay.png"):(LOOPmode="repeated",document.getElementById("loopImg").src="../../Icons/transInfinity.png"),loopMsg()}function loopMsg(e){var t="Loop Start: "+secToMin(LOOPtop*SCROLLkon/1e3)+"......Loop End: "+secToMin(LOOPend*SCROLLkon/1e3)+"......"+LOOPmode+"!";"true"==e?alert(t):statusMsg(t,"yellow")}function loopMark(e){var t=document.getElementById("Tune").scrollTop,n=parseInt(t*DUR/SCROLLpix,10);"start"==e?(LOOPtopBU=LOOPtop=t,msg="Loop set to Start at "+n+"seconds",document.getElementById("lt").innerHTML=n+"<br>Top"):(LOOPendBU=LOOPend=t,msg="Loop set to Finish at "+n+" seconds",document.getElementById("le").innerHTML=n+"<br>End"),statusMsg(msg,"yellow")}function loopOn(){!0===LOOPon?(LOOPon=!1,document.getElementById("playLoop").style.backgroundImage="url('../../Icons/off.png')",dis("loopBlock","none")):(LOOPon=!0,dis("loopBlock","block"),LOOPend=LOOPendBU,LOOPtop=LOOPtopBU,document.getElementById("playLoop").style.backgroundImage="url('../../Icons/on.png')")}function loopClear(){LOOPtop=0,LOOPend=SCROLLpix,document.getElementById("lt").innerHTML="0<br>Top",document.getElementById("le").innerHTML=parseInt(DUR,10)+"<br>End",statusMsg("Loop Set to Entire Song...","yellow")}function loopDelay(e){e=(e=e.split("<br>")[0])<20?parseInt(2*e,10):2,document.getElementById("ld").innerHTML=e+"<br>Delay"}function resetLoop(e,t){Audio1.pause(),clearTimeout(TIMEOUTscroll);void 0===e&&(e=0,screenFormat("Think"),t=parseFloat((LOOPtop-LOOPend)/30,10),statusMsg("Resetting Loop ","orange")),(e+=1)<30?TIMEOUTscroll=setTimeout(function(){document.getElementById("Tune").scrollTop=document.getElementById("Tune").scrollTop+t,resetLoop(e,t)},50):trackReset()}function showSetting(e){statusMsg("Displaying key, tempo or track type",0),2<e?(document.getElementById("mirror").style.color="transparent",document.getElementById("mirrorImage").src=document.getElementById("buttonTrack2").src="../../Icons/"+SOUNDicon):(document.getElementById("mirror").style.color="black",document.getElementById("mirrorImage").src="../../Icons/transCircleWhite.png"),0===e?document.getElementById("key2").innerHTML=document.getElementById("mirror").innerHTML=KEY:document.getElementById("speed2").innerHTML=document.getElementById("mirror").innerHTML=BPM}function listTempos(){var e,t,n,o,l,s,r=0,i="";if("BACK TRACK"==SOUNDmode)i="TEMPO SET BY THE BACKING TRACK<br>"+BPM+"<br>IT CANNOT BE CHANGED";else{for("SILENT"==SOUNDmode|!0===AUDfail?(e=50,t=300,n=5):"DRUM ROCK"==SOUNDmode?(e=70,t=220,n=5):"CLICK TRACK"==SOUNDmode?(e=70,t=190,n=5):"DRUM COUNTRY"==SOUNDmode?(e=70,t=220,n=10):alert("UNKNOWN ERROR SOUND MODE "+SOUNDmode+" DOES NOT EXIST!"),o=e,r=0;o<BPM;)o+=n,r++;for(i="<br><a onclick = 'setBPM("+o+")' style='color:red'>"+o+"</a><br>",r=1;r<=10;)(l=o+r*n)<=t&&(i="<a onclick = 'setBPM("+l+");SONGlastCustom=1;showSetting(1);'> "+l+"</a>-"+i),e<=(s=o-r*n)&&(i=i+"<a onclick = 'setBPM("+s+");SONGlastCustom=1;showSetting(1);'> "+s+"</a>-"),r+=1}document.getElementById("tempo2").innerHTML=i}function newKey(e){var t,n=e,o=!1,l=0;if("N"!=KEY){for("#"==n.substring(1,2)&&(n=n.substring(0,1)+"s"),"N"==e&&(o=!0,e="A");ARRscale[l]!==KEY;)l++;for(t=l;ARRscale[t]!==e;)t++;TRANSPOSE=t-l,!1!==o&&(e="N"),document.getElementById("key2").src="../../Icons/key"+n+".png",KEYlast=KEY,statusMsg("Transposed to "+(KEY=e)+"and arrConvert()initiated",0),arrConvert()}else alert("Not Programed to transpose From Nashville Notation\nSimply move to another song and back to clear Nashville Notation!\n SORRY...")}function setBPM(e){"SILENT"==SOUNDmode?(BPM=e,durCalc()):(BPM=e,showSetting(1),loadServerTrack()),listTempos(),statusMsg("Set BPM to "+e,0)}function setSoundModeDefault(e){var t=ARRsoundModes.indexOf(e);document.getElementById("soundSelector").selectedIndex=t,SOUNDmodeDefault=SOUNDmode=e,!1===BOOT&&selectTune(TITLEplus)}function setSoundMode(e,t){statusMsg("Sound mode: "+e+">>>>"+SOUNDicon),showSetting(2),SOUNDmode=e,loadServerTrack()}function presets(e){statusMsg("Initiating preset: "+PRESET+": "+PRESETno,0),PRESETno=0,"Default Mode"===PRESET?"presets"==e?(ARRtf="true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false".split(","),setCustom(ARRpresets[PRESETno],ARRtf[PRESETno],"presets")):"wrap"==e&&(document.getElementById("soundSelector").selectedIndex=0,setSoundModeDefault(document.getElementById("soundSelector").value),selectPlaylist("ALL TUNES"),document.getElementById("Set").value="ALL TUNES"):"Perform Mode"===PRESET?"presets"==e?(ARRtf="true,true,false,true,false,false,true,true,false,false,true,true,true,true,false,false,true".split(","),setCustom(ARRpresets[PRESETno],ARRtf[PRESETno],"presets")):"wrap"==e&&(document.getElementById("soundSelector").selectedIndex=2,setSoundModeDefault(document.getElementById("soundSelector").value),selectPlaylist("A-Fred Solo"),document.getElementById("Set").value="A-Fred Solo"):"Practice Mode"===PRESET?"presets"==e?(ARRtf="true,false,false,true,false,false,true,false,false,false,false,true,true,true,true,true,true,false".split(","),setCustom(ARRpresets[PRESETno],ARRtf[PRESETno],"presets")):"wrap"==e&&(alert("WRAP "+PRESET),document.getElementById("soundSelector").selectedIndex=0,setSoundModeDefault(document.getElementById("soundSelector").value),selectPlaylist("Breen"),document.getElementById("Set").value="Breen"):"Developer Mode"===PRESET&&("presets"==e?(ARRtf="true,false,false,false,false,false,false,false,false,false,false,true,true,true,true,true,true,true".split(","),setCustom(ARRpresets[PRESETno],ARRtf[PRESETno],"presets")):"wrap"==e&&(alert("WRAP "+PRESET),document.getElementById("soundSelector").selectedIndex=3,setSoundModeDefault(document.getElementById("soundSelector").value),selectPlaylist("Fred Inwork"),document.getElementById("Set").value="Fred Inwork"),statusMsg("<X2>"+PRESET+" selected by the user...\n----------------------------------------</X2>",PRESETno=0),barSelect())}function setCustom(e,t,n){var o,l;AC=!1,"toggle"!=n&"presets"!==n?alert("ERROR\nUnknown preset action: "+n):("toggle"===n?(statusMsg(e+"-"+t+"-"+n),e==BREAKlines&&e==BIGchords||(l=!0===window[e]?(window[e]=!1,"off.png"):(window[e]=!0,"on.png")),AC=!0,document.getElementById("img"+e).src="../../Icons/"+l,statusMsg("User Toggled: "+e+"to "+window[e],0)):"presets"==n?(AC=!0,e=ARRpresets[PRESETno],t="true"===(t=ARRtf[PRESETno]),o="img"+ARRpresets[PRESETno],statusMsg(PRESETno+": "+e+"="+t+"-"+n),!0===t?(l="on.png",window[e]=!0):!1===t&&(l="off.png",window[e]=!1),document.getElementById(o).src="../../Icons/"+l,statusMsg(PRESET+">"+e+">"+o+">"+l+">"+t)):"wrap"==n&&arrConvert(),"BREAKlines"==e&&(35<LINElimit?(LINElimit=parseInt(LINElimit-5,0),document.getElementById("imgBREAKlines").src="../../Icons/on.png"):(LINElimit=90,document.getElementById("imgBREAKlines").src="../../Icons/off.png"),document.getElementById("breakLines").innerHTML="CHAR<br>"+LINElimit+"/ln",AC=!0),"BIGchords"==e&&(2.2<(BIGchordSize+=.25)&&(BIGchordSize=1),document.getElementById("imgBIGchords").src=1==BIGchordSize?"../../Icons/off.png":"../../Icons/on.png",document.getElementById("bcp").innerHTML="Chord<br>"+parseInt(100*BIGchordSize)+"%",AC=!0),"SETnotes"==e&!0===SETnotes&&(document.getElementById("imgPOPnotes").src="../../Icons/off.png",POPnotes=!1,document.getElementById("imgTECHnotes").src="../../Icons/off.png",AC=TECHnotes=!1),"POPnotes"==e&!0===POPnotes&&(document.getElementById("imgSETnotes").src="../../Icons/off.png",SETnotes=!1,document.getElementById("imgTECHnotes").src="../../Icons/off.png",AC=TECHnotes=!1),"TECHnotes"==e&!0===TECHnotes&&(document.getElementById("imgSETnotes").src="../../Icons/off.png",SETnotes=!1,document.getElementById("imgPOPnotes").src="../../Icons/off.png",AC=POPnotes=!1),"LINEnum"==e&!0===LINEnum&&(window[LINEtime]=!1,document.getElementById("imgLINEtime").src="../../Icons/off.png",AC=!(LINEtime=!1)),"LINEtime"==e&!0===LINEtime&&(window[LINEnum]=!1,document.getElementById("imgLINEnum").src="../../Icons/off.png",AC=!(LINEnum=!1)),"FULLscreen"==e&&(!0===FULLscreen?launchIntoFullscreen(document.documentElement):exitFullscreen()),"LOOPER"==e&&(document.getElementById("looper").style.display=!0===LOOPER?"block":"none"),"TEXT"==e&&(document.getElementById("imgTEXT").src=!0===TEXT?"../../Icons/on.png":"../../Icons/off.png"),"BARsync"==e&&!1===BARsync&&(document.getElementById("imgMETRO").src="../../Icons/off.png",METRO=!1),"toggle"===n?!0===AC|"true"==AC&&(statusMsg("Toggle required array converstion"),arrConvert()):"presets"===n&&(15<PRESETno?(statusMsg("<X2>arrConvert Triggered Preset ALL...</X2>",0),presets("wrap")):(PRESETno+=1,setCustom("","","presets"))))}function launchIntoFullscreen(e){e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}function exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():element.msCancelFullscreen&&document.msCancelFullscreen()}function tgl(e,t){t?window[e]=t:!0===window[e]?window[e]=!1:window[e]=!0,!0===window[e]?document.getElementById("img"+e).src="../../Icons/on.png":document.getElementById("img"+e).src="../../Icons/off.png"}function togl(e){tgl(e),"LINEtime"==e&&!0===LINEnum?tgl("LINEnum",!1):"LINEnum"==e&&!0===LINEnum&&tgl("LINEtime",!1)}function volOnOff(){!1===SOUND?(SOUND=!0,document.getElementById("soundOO").style.backgroundImage="url('../../Icons/on.png')",document.getElementById("Audio1").volume=VOLdefault,dis("vCont","block")):(SOUND=!1,document.getElementById("soundOO").style.backgroundImage="url('../../Icons/off.png')",document.getElementById("Audio1").volume=0,dis("vCont","none"))}function volSet(e){!0===isNaN(e)?VOL=VOLdefault:e<1&-1<e?(1<=(VOL=parseFloat(VOL+e,10))&&(VOL=1),VOL<=0&&(VOL=0),VOLdefault=VOL):VOL=1<e&e<=100?parseInt(e,10)/100:0,document.getElementById("V").innerHTML=parseInt(100*VOL,10)+"%",document.getElementById("Audio1").volume=document.getElementById("aB").volume=document.getElementById("aC").volume=VOL}function revDates(){var e=new XMLHttpRequest;return e.open("HEAD",JSname,!1),e.send(null),"HTML: "+document.lastModified+"  <>  JAVASCRIPT: "+new Date(e.getResponseHeader("Last-Modified")).toLocaleString()}function indx(e){var t=0;document.getElementById("mySet").selectedIndex=t;for(var n=document.getElementById("mySet").value;n.substring(0,1)!==e;){document.getElementById("mySet").selectedIndex=t;n=document.getElementById("mySet").value;if(t++,document.getElementById("mySet").value,t==document.getElementById("mySet").length-1)return void statusMsg("No Tunes Starting with "+e,"yellow")}selectTuneNo(t)}function changeBackgroundImage(e,t){t="url("+t+")";document.getElementById(e).style.backgroundImage=t}function bcPct(){alert("shit\n bcPCT is apparently dead this is a trip wire")}function lineTranspose(e,t){if(0===t)s=e;else for(var n="",o="",l=0,s="",r=0;r<e.length;){if(" "==e[r])if(0===o.length)0<l?l=parseInt(l-1,10):s+=" ";else{if((l+=(n=chordTranspose(o,t)).length-o.length)<0)for(;l<0;)l+=1,n+=" ";s=s+n+" ",n=o=""}else o+=e[r],r==e.length-1&&(s+=chordTranspose(o,t));r+=1}return s}function chordTranspose(e,t){var n="";if(0===t)n=e;else{var o=0;for(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/A#/g,"Bb")).replace(/B#/g,"C")).replace(/Cb/g,"B")).replace(/Db/g,"C#")).replace(/D#/g,"Eb")).replace(/Fb/g,"E")).replace(/E#/g,"F")).replace(/Gb/g,"F#")).replace(/G#/g,"Ab"),o=0;o<e.length;){var l=1;"A"==e[o]|"B"==e[o]|"C"==e[o]|"D"==e[o]|"E"==e[o]|"F"==e[o]|"G"==e[o]?o<e.length-1&&"#"==e[o+1]|"b"==e[o+1]?(n+=noteTranspose(e[o]+e[o+1],t),l=2):n+=noteTranspose(e[o],t):n+=e[o],o+=l}}return n}function noteTranspose(e,t){var n="?",o="A,Bb,B,C,C#,D,Eb,E,F,F#,G,Ab,A,Bb,B,C,C#,D,Eb,E,F,F#,G,Ab,A,Bb,B,C,C#,D,Eb,E,F,F#,G,Ab".split(",");for(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/A#/g,"Bb")).replace(/B#/g,"C")).replace(/Cb/g,"B")).replace(/Db/g,"C#")).replace(/D#/g,"Eb")).replace(/Fb/g,"E")).replace(/E#/g,"F")).replace(/Gb/g,"F#")).replace(/G#/g,"Ab"),i=13;i<38&&o[i]!=e;i++);return n=o[i+t],"N"==KEY&&(n="A"==n?"1":"Bb"==n?"2b":"B"==n?"2":"C"==n?"3b":"C#"==n?"3":"D"==n?"4":"Eb"==n?"5b":"E"==n?"5":"F"==n?"6b":"F#"==n?"6":"G"==n?"7b":"Ab#"==n?"7":"??"),n}function delay(e){statusMsg("#####################################################",0);for(var t=(new Date).getTime()+e;(new Date).getTime()<t;)0;statusMsg("#=========="+e+"ms PAUSE==========",0)}function printContent(){var e=document.getElementById("content").innerHTML,e="<X100>"+TITLE+"<br>"+listChords()+"</X100><br>"+e.replace(/<br>/g,"");window.open("","Title","toolbar=yes,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes").document.body.innerHTML=e}function notes(){window.open(encodeURI("notes.html?"+encodeFredComponent(ARRlines.join("\n"))+"?"+encodeFredComponent(TITLE)))}function home(){window.open("index.html")}function history(){window.open("player.txt")}function iRealLink(){1==confirm("If this computer has Ireal Pro installed press OK.\n Otherwise; Cancel this operation to see the Ireal Text file.")&&window.open(IRB)}function fileMaster(){window.open("FileMaster.html")}function songSum(){var e="<X1>"+parseInt(TUNEnum+1,10)+"/"+parseInt(PLAYlist.length,10);return e=(e=e+"</X1> <X8>|</X8>"+secToMin(DUR)+" ("+DURsource+") <X8>|</X8> <X1>Sig: "+BEATS+"/4 </X1>")+"<X8>|</X8> {"+listChords()+"}"}function analizeSong(){var e=0<parseFloat(DURmp3-DURcalc,0)?"2":"1",t="TITLE: "+TITLE+" (SOUND MODE: "+SOUNDmode+")";return t=(t=(t=(t=(t=(t=(t=(t=(t=t+"<br>PLAYLIST: "+SETname+"<br>=======================")+"<br>KEY: "+KEYbase+" (Transposed to "+KEY+")")+"<br>TIME SIG: "+BEATS+"<br>MEASURES : "+MEASURES+"<br>BARS: "+BARS+" (half Bars:"+BARShalf+")<br>TEMPO: "+BPM+" BPM<br>QUALITY: "+QUAL)+"<br>GENRE: "+GENRE+"<br>STYLE: "+STYLE+"<br>ARTIST: "+ARTIST)+"<br>HIT YEAR: "+HITyear)+"<br>======================<br>DURATION: "+DUR+" ("+secToMin(DUR)+")<br>DUR SOURCE: "+DURsource)+"<br>   DUR CALC: "+DURcalc+" ("+secToMin(DURcalc)+") 100%")+"<br>   DUR FILE: "+DURtext+" ("+secToMin(DURtext)+")"+parseInt(100*DURtext/DURcalc,10)+"%")+"<br>   DUR MP3: "+parseInt(DURmp3,10)+" ("+secToMin(DURmp3)+")"+parseInt(100*DURmp3/DURcalc,10)+"%",t+="<br>======================<br>MP3 vs SCROLL Discrepancy",t=(t=(t+="<br>Assumes you have verified both Tempos...")+"<br>   DUR MP3: "+DURmp3+" sec ("+DURmp3/BARS+" sec/Bar)")+"<br>   .......: "+60*BARS*BEATS/DURmp3+" BPM",t+="<br>Red indicates Time missing from the File",t=(t=(t+="<br>Green indicates time missing from the Audio")+"<br><X"+e+">   Rqd BEATS:"+parseFloat(BPM*(DURmp3-DURcalc)/60,0))+"<br>   Rqd BARS:"+parseFloat(BPM*(DURmp3-DURcalc)/(60*BEATS),0)+"<br></X"+e+">",t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t+="<br>======================<br>TECHNICAL INFO")+"<br>   ASPECT RATIO: "+parseFloat(1/RAT))+"<br>   LONGEST LINE: "+LONGLINE+" charcters")+"<br>   PRE-SONG LINES: "+PRESONGlines+" lines")+"<br>   CHORD LINES: "+CHORDlines+" lines")+"<br>   WINDOW HT: "+WINDht+"px ("+parseInt(100*WINDht/PAGEht,10)+")%")+"<br>   DOCUMENT HT: "+PAGEht+"px")+"<br>   SCROLL PIX: "+SCROLLpix+"px")+"<br>   TUNE SCROLL PIX: "+document.getElementById("Tune").scrollHeight+"px")+"<br>   CONTENT SCROLL PIX: "+document.getElementById("content").scrollHeight+"px")+"<br>   WINDOW WIDTH: "+WINDwt+"px")+"<br>   SCROLL RATE: "+parseInt(SCROLLkon,10)+" micro-sec/pixel")+"<br>   SCROLL POSITION: "+document.getElementById("Tune").scrollTop+"px")+"<br>======================<br>CHORDS<br>"+listChords()+"<br>=======================================END=======================================<br>"}function getTempo(){var e=new Date;2e3<(TEMPOtime=e.getTime())-TEMPOtimeLast?(TEMPO=1e3,TEMPOcount=0,TEMPOstart=TEMPOtimeLast=TEMPOtime,document.getElementById("tempoGetter").innerHTML="TEMPO TOOL"):(TEMPOtime=e.getTime(),TEMPOcount+=1,e=(TEMPOtime-TEMPOstart)/6e4,TEMPO=parseInt(10*TEMPOcount/e,10)/10,document.getElementById("tempoGetter").innerHTML=TEMPO+" bpm:  ("+parseInt(60*e,10)+" sec Sample)",document.getElementById("btTempo").value=TEMPO,TEMPOtimeLast=TEMPOtime)}function lyricLineCount(){for(var e=0,t=0;t<ARRlines.length;)"lyric"==lineType(ARRlines[t])&&e++,t++;return e}function getTextFileFetch(e){fetch(e).then(e=>e.text()).then(e=>{console.log(e)})}function getTextFile(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText}function chordLines(){for(var e=0,t=0;e<ARRlines.length;)"chord"==lineType(ARRlines[e])&&(t+=1),e++;return t}function isHeader(e){var t=!1,e=e.substring(0,5).toUpperCase();return"VERSE"==e|"#VERS"==e|"CHORU"==e|"#CHOR"==e|"BREAK"==e|"#BREA"==e|"INTRO"==e|"#INTR"==e|"OUTRO"==e|"#OUTR"==e|"#BRIDG"==e|"#BRID"==e|"#TURN "==e|"#TURN"==e&&(t=!0),t}function countChr(e,t){for(var n=0,o=0;n<e.length;)e[n]==t&&o++,n++;return o}function listChords(){var e=ARRlines,t="";for(j=0;j<e.length;)"chord"==lineType(e[j])&&(0!==TRANSPOSE&&(e[j]=lineTranspose(e[j],TRANSPOSE)),t+=e[j]),j++;return t=unique(e=(t=(t=(t=(e=(t=(e=(t=(e=(t=(e=(t=(e=(t=(e=(t=(e=(t=t.replace(/~/g," |")).split("*")).join("")).split("||")).join("@")).split("|%")).join("")).split("| ")).join("")).split("@")).join("|")).split("|NC")).join("")).split("^")).join("")).replace(/ /g,"")).substr(1)).split("|")).join(" - ")}function firstLineValues(e){BPM=120,BEATS=4,KEY="C","hash"==lineType(ARRlines[0])&&(TITLE=decodeURI(hash(ARRlines[0],"TITLE",TITLE)),DURtext=hash(ARRlines[0],"DUR",""),BPM=hash(ARRlines[0],"BPM",BPM),BEATS=hash(ARRlines[0],"BEATS",BEATS),0===(KEY=hash(ARRlines[0],"KEY",KEY))|"0"==KEY&&(KEY="C"),"Inwork"!==(QUAL=hash(ARRlines[0],"QUAL",QUAL))&"Verified"!==QUAL&"Complete"!==QUAL&&(QUAL="Raw"),"Inwork"==QUAL&&(STARS=2),STARS="Preliminary"==QUAL?3:"Verified"==QUAL?4:"Complete"==QUAL?5:1,GENRE=hash(ARRlines[0],"GENRE","Unknown"),STYLE=hash(ARRlines[0],"STYLE","Unknown"),HITyear=hash(ARRlines[0],"HITyear","Unknown"),ARTIST=hash(ARRlines[0],"ARTIST","Unknown"))}function setUpListener(){document.getElementById("fileinput").addEventListener("change",loadFile,!1)}function loadFile(e){SONGsource="request",readSingleFile(e),setTimeout(function(){createARRlines(RAWtune),document.getElementById("myTune").innerHTML=TITLE,barSelect()},2e3)}function readSingleFile(e){statusMsg("Reading file..."),file=e.target.files[0],file?((e=new FileReader).onload=function(e){RAWtune=e.target.result,TITLE=file.name.substring(0,file.name.length-4)},e.readAsText(file)):alert("No Valid File...")}function barSelect(e){var t="configuration,tool,songbar,cloud".split(","),n=0,o=!1;for("none"==e&&(o=!1);n<t.length;)e==t[n]&"none"===document.getElementById(t[n]).style.display?(dis(t[n],"block"),o=!0,statusMsg(e.toUpperCase()+" BAR Opened...","yellow")):dis(t[n],"none"),n++;!1===o&&statusMsg("All TOOLBARS CLOSED...","yellow")}function triviaNotes(){return"<center>"+TITLE.toUpperCase()+"<br>ARTIST: "+ARTIST+" < > HIT YEAR; "+HITyear+"</center><br>"+NOTEtrivia}function playlistNotes(){return NOTEset}function clockRun(){var e=(new Date).toLocaleString(),t=e.split(" ")[2];e=(e=e.split(",")[1]).substring(0,e.length-6),document.getElementById("clock").innerHTML=e+" "+t,TIMEOUTclock=setTimeout(function(){clockRun()},3e4)}function printFormat(){for(var e="",t=0,n=parseInt(ARRlines.length-1,10);t<n;)e=e+"\n"+ARRlines[t],t++;return e}function fileFromPath(e){return(e=e.split("/"))[e.length-1]}function secToMin(e){var t=parseInt(e/60,10),e=parseInt(60*parseFloat(e/60-parseInt(e/60,10)),10);return t+(e=e<10?":0"+e:":"+e)}function hash(e,t,n){for(var o=e.split(","),l=0;l<o.length;){var s=o[l].split(":");s[0]==t&&(n=s[1],l=o.length),l++}return n}function dis(e,t){void 0===t?"none"==document.getElementById(e).style.display?document.getElementById(e).style.display="block":document.getElementById(e).style.display="none":document.getElementById(e).style.display="none"==t?"none":"block"}function vis(e,t){void 0===t&&(t="visible"==document.getElementById(e).style.visibility?"hidden":"visible"),document.getElementById(e).style.visibility=t}function receiveARR(e,t){var n=window.name,e=void 0===e?decodeURIComponent(decodeFredComponent(window.name)):decodeURIComponent(decodeFredComponent(window.name)).split(e);return!0===t|void 0===t|""===t&&(window.name=n),e}function passARR(e,t,n,o){t=!0===Array.isArray(t)?t.join(n):t;null!==o&&(t=o+n+t),window.open(e,encodeURI(encodeFredComponent(t)),"toolbar=yes,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes"),dis("prntType","none")}function encodeFredComponent(e){return e=(e=(e=(e=e.split("?")).join("QMARK")).split("@")).join("AMARK")}function decodeFredComponent(e){return e=(e=(e=(e=e.split("QMARK")).join("?")).split("AMARK")).join("@")}function lineType(e){var t="lyric";return"IREALB:"==e.substring(0,7).toUpperCase()?t="irealb":"TAB:"==e.substring(0,4).toUpperCase()?t="tab":"http"==e.substring(0,4)?t="link":"@@@"==e.substring(0,3)?t="noteTech":"@@"==e.substring(0,2)?t="noteTriv":"@"==e.substring(0,1)?t="note":"#"==e.substring(0,1)?t="header":"$$"==e.substring(0,2)?t="noteLive":"$"==e.substring(0,1)?t="spacer":-1<e.search(":")?t="hash":-1<e.indexOf("|")&&(t="chord"),t}function longestLine(){for(var e=0,t=0;t<ARRlines.length;){var n=lineType(ARRlines[t]);"lyric"==n|"chord"==n&&ARRlines[t].length>e&&(e=ARRlines[t].length),t++}return e}function stdTime(e,t){var n=0,o=0,l=0,s="AM";if(!(null===e|void 0===e|""===e|" "===e))return e;e=new Date,o=e.getHours(),l=e.getMinutes(),n=e.getSeconds();return 11<o&&(s="PM"),12<o&&(o-=12),l<10&&(l="0"+l),!0===t&&(n<10&&(n="0"+n),l=l+":"+n),o+":"+l+s}function barsClear(){for(i=0;i<ARRbars.length;i++){var e="b"+i;document.getElementById(e).style.backgroundColor="transparent"}statusMsg("ALL BARS: "+BARS+" cleared..",0)}function statusMsg(e,t,n){null!==e&&""!==e&&" "!==e&&null!=e||(e="ERROR: No Status Message Passed"),0<STATUSmode&&(ARRstatusLog.length>LOG&&ARRstatusLog.pop(),0==t?ARRstatusLog.splice(0,0,stdTime("",!0)+"       <X8>"+e+"</X8>"):ARRstatusLog.splice(0,0,stdTime("",!0)+"  <X1>"+e+"</X1>")),1<STATUSmode&&(document.getElementById("bootText").innerHTML="<pre>"+ARRstatusLog.join("<br>")+"</pre>"),0!=t&&(1!=t?sm2(e,t,n):alert("STATUS MSG\n"+e))}function sm2(e,t,n){var o="black";null===e?e="*"+MSGlast:MSGlast=e,"block"==document.getElementById("splash").style.display?t="transparent":"black"==t|"red"==t|"green"==t|"blue"==t|"grey"==t?o="white":"yellow"==t|"transparent"==t?o="green":"none"==t|"transparent"==t?o="transparent":t="lightgrey",!0===n&&(e="<marquee><mark>"+e+"</mark></marquee>",t="yellow"),document.getElementById("msg").style.color=o,document.getElementById("msg").style.backgroundColor=t,document.getElementById("msg").innerHTML=e}function statusMonitor(e){var t="";0===e?(t="<X2>Debug Log Deactivated</X2>",dis("statusWindow","none"),dis("bug","none")):t=1===e?(dis("statusWindow","none"),dis("bug","block"),"<X2>Debug Log Active and Hidden</X2>"):(e=2,dis("statusWindow","block"),dis("bug","block"),"<X2>Debug Log Active and Displayed</X2>"),STATUSmode=e,statusMsg(t,"yellow")}function monitorWindow(){dis("statusWindow"),"block"===document.getElementById("statusWindow").style.display?(statusMonitor(2),document.getElementById("bootText").innerHTML="<pre>"+ARRstatusLog.join("<br>")+"</pre>"):statusMonitor(1)}function setMonitor(){statusMonitor(0===STATUSmode?2:0)}function bugButton(e){var t="";"Scroll"===e&&(t=(t=(t=(t=(t="BPM: "+BPM+"  BARS:"+ARRbars.length+" ("+BARShalf+" half bars)\nMEASURES: "+MEASURES+" at "+BEATS+" beats per Measure = "+BEATS*MEASURES)+" Total Beats\nDUR: "+DUR+" seconds  Duration Source: "+DURsource+"\n")+"Scroll Time: "+parseInt(1e6*document.getElementById("Tune").scrollTop/SCROLLpix,10)/1e4)+"%  Scroll Top: "+document.getElementById("Tune").scrollTop+" of "+SCROLLpix+"\n")+"Track  Time: "+parseInt(1e6*document.getElementById("Audio1").currentTime/DURmp3,10)/1e4+"%  Current Seconds: "+document.getElementById("Audio1").currentTime+" of "+document.getElementById("Audio1").duration+" "),"ARRbars"===e&&(t=ARRbars.join(",")),t=e+"----------\n"+t+"\n"+e+"^^^^^^^^^^^^^^\n",document.getElementById("devText").innerHTML=t,dis("devText","block")}function badCode(){alert(parseInt(1/0,10))}function devShrink(){"3vw"==document.getElementById("developer").style.width?(document.getElementById("developer").style.height="7vw",document.getElementById("developer").style.width="24vw",document.getElementById("devShrink").style.top="0vw",document.getElementById("devShrink").style.height="1vw",document.getElementById("devShrink").innerHTML="HIDE"):(document.getElementById("developer").style.height="3vw",document.getElementById("developer").style.width="3vw",document.getElementById("devShrink").style.top="1vw",document.getElementById("devShrink").style.height="2vw",document.getElementById("devShrink").innerHTML="SHOW")}function toggleShit(){1==SHIT?(SHIT=!1,document.getElementById("tShit").src="../../Icons/NS.png"):(SHIT=!0,document.getElementById("tShit").src="../../Icons/DS.png",statusMsg("You're in DEEP SHIT!")),arrConvert()}function dragElement(t){var n=0,o=0,l=0,s=0;function e(e){(e=e||window.event).preventDefault(),l=e.clientX,s=e.clientY,document.onmouseup=i,document.ontouchend=i,document.onmousemove=r,document.ontouchmove=r}function r(e){(e=e||window.event).preventDefault(),n=l-e.clientX,o=s-e.clientY,l=e.clientX,s=e.clientY,t.style.top=t.offsetTop-o+"px",t.style.left=t.offsetLeft-n+"px"}function i(){document.onmouseup=null,document.onmousemove=null,document.ontouchend=null,document.ontouchmove=null}document.getElementById(t.id+"header")?(document.getElementById(t.id+"header").onmousedown=e,document.getElementById(t.id+"header").ontouchstart=e):(t.onmousedown=e,t.ontouchstart=e)}function bogus(){flash("BOGUS BLINKER AND FLASH DEMO!",4),blinker("ButtonHome",24)}function sleep(e){statusMsg("<X2>SLEEPING for "+e+"milliseconds</X2>");for(var t=(new Date).getTime();t+e>=(new Date).getTime(););}function flash(e,t){var n;e!==MSGlast&&(n=MSGlast,void 0===t&&(t=3),t=parseInt(1e3*t,10),statusMsg(e,"red"),setTimeout(function(){statusMsg(n)},t))}function blinker(e,t){var n=document.getElementById(e);0<t?("visible"==n.style.visibility?n.style.visibility="hidden":n.style.visibility="visible",TIMEOUTblink=setTimeout(function(){clearTimeout(TIMEOUTblink),blinker(e,--t)},125)):(clearTimeout(TIMEOUTblink),n.style.visibility="visible")}function countBARS(){MAP="".split(","),ARRbars.length=0;CHORDlines=BARSperLine=BARShalf=BARS=0;for(var e,t=parseInt(MAPoffset,10),n=0,o=0,l=0;o<ARRlines.length;){var s=ARRlines[o];if("header"===lineType(s)&&MAP.push(s),"chord"==lineType(s))for(CHORDlines+=1,l=0;l<s.length;l++)"|"===s.charAt(l)&&(e=1,t=parseInt(t+1,10),"*"===s.charAt(l+1)&&(e=.5,BARShalf+=1),n+=e,ARRbars.push(n),BARS+=1,0<t&&MAP.push(t));"chord"===lineType(s)|"header"===lineType(s)&&MAP.push("\n"),o+=1}0<CHORDlines&&(BARSperLine=BARS/CHORDlines),statusMsg("MEASURES: "+(MEASURES=BARS-.5*BARShalf)+" / BARS:"+BARS+" (Full:"+parseInt(BARS-BARShalf)+" & HALF:"+BARShalf+") CHORD LINES: "+CHORDlines+"   BARS/LINE: "+BARSperLine,0)}function rollMirror(e){clearTimeout(TIMEOUTmirror),!0===e&&(MIRROR<3?(document.getElementById("mirror").style.color="black",1===MIRROR?(document.getElementById("mirror").innerHTML=parseInt(parseFloat(BPM,10)+.49,10),document.getElementById("mirrorImage").src="../../Icons/transCircleGreen.png"):2===MIRROR?(document.getElementById("mirror").innerHTML=KEY,document.getElementById("mirrorImage").src="../../Icons/transCircleYellow.png"):(document.getElementById("mirror").innerHTML=STARS,document.getElementById("mirrorImage").src="../../Icons/transCircleStar.png"),MIRROR++):(MIRROR=0,document.getElementById("mirrorImage").src="../../Icons/"+SOUNDicon,document.getElementById("mirror").style.color="transparent"),TIMEOUTmirror=setTimeout(function(){rollMirror(!0)},1e3))}function breakLine(e){for(var t,n="",o="",l=200,s=10;s<l;)l=e.length,s=(e=e.split("  ").join(" ")).length;if(e.length<=LINElimit)n=e;else{for(t=parseInt(.5*s,10)-2;" "!==e.substring(t-1,t);)--t;n=e.substring(0,t);var r=LINElimit-e.substring(t,e.length).length;for(k=1;k<r-2;k++)o+=" ";n=n+"<br>"+o+e.substring(t,e.length)}return n}function opacSet(e,t){void 0===t|null===t|1<t&&(t=1),document.getElementById(e).style.opacity=t}window.onload=function(){var e=navigator.userAgent.split(")").reverse()[0].match(/(?!Gecko|Version|[A-Za-z]+?Web[Kk]it)[A-Z][a-z]+/g)[0];ARRstatusLog=("================BOOTING in "+e+"==================").split("-"),statusMsg("PRESS ANY KEY or CLICK THE 'BUG' to monitor the boot..."),document.getElementById("debugTrigger").focus(),TIMEOUTcrap=setTimeout(function(){start()},1500)},dragElement(document.getElementById("backtracker")),dragElement(document.getElementById("statusWindow")),dragElement(document.getElementById("cloud")),dragElement(document.getElementById("mailer")),dragElement(document.getElementById("localAction")),dragElement(document.getElementById("developer"));