var JSdate,ARRtitle,PREVtitle,RAWtune,BARSperLine,IRB,NOTEset,NOTEtrivia,NOTEtech,NOTElinks,TOPlast,SCROLLbase,SCROLLpix,TIMEOUTblink,TIMEOUTcrap,TIMEOUTdelay,TIMEOUTfade,TIMEOUTnext,TIMEOUTscroll,TIMEOUTmirror,TIMEOUTwait,ARRsongSettings,WINDht,WINDwt,BARShalf,REV="Beta",JSname="NextPlayer.js",ALT=!1,AUDfail=!1,AUDend=!1,BOOT=!0,NASH=!1,NOTESpresent=!1,SCROLLend=!1,SETnoteViewed=!1,ARRsoundModes="SILENT/nBACK TRACK/nCLICK TRACK/nVOCAL/nDRUM ROCK/nDRUM COUNTRY/nDRUM COUNT".split("/n"),DUR=120,DURsource="Default",DURcalc=0,DURmp3=0,KEYlast="C",KEYbase="X",LINElimit=90,LONGLINE=40,MIRROR=0,TRANSPOSE=0,SOUNDmodeDefault="SILENT",SOUNDmode="SILENT",SOUNDicon="transSilent.png",TUNEnum=0,VOL=.5,VOLexp=2,WARNING="No Warnings!",ARTIST="Unknown",ARRlines="",BARS=0,BEATS=4,BPM=100,DURtext=0,GENRE="Unknown",HITyear="Unknown",KEY="C",MEASURES=0,QUAL="Raw",STARS=1,STYLE="Unknown",TITLE="Unknown",TITLEplus="unknown",SONGicon="transSilent.png",SS=0,AS=0,FONTSIZE=2.5,CHORDlines=0,PRESONGlines=0,SCROLLkon=.01,SCROLLstartTime=0,Ypos=0,Ystart=0,TIMEOUTintro=100,ARRpresets="CAPS,FULLscreen,LEFTborder,CLOCK,TEXT,SHADE,NOTES,SETnotes,POPnotes,TECHnotes,AUTOnext,COUNTin,CLICKER,BREAKlines,BIGchords,LOOPER,BARsync".split(","),AUTOnext=!1,BACKdrop=!1,BARsync=!1,BIGchords=!1,BIGchordSize=1,BREAKlines=!1,CAPS=!0,CLOCK=!1,CLOCKstart=0,CLOCKstop=0,CLICKER=!1,COUNTin=!1,COUNTloops=0,COUNTlimit=1,FULLscreen=!1,LEFTborder=!1,LINEnum=!1,LINEtime=!1,LINKnotes=!1,NOTES=!1,POPnotes=!1,SHADE=!1,SOUND=!0,SETnotes=!1,TEXT=!1,TRIVIAnotes=!1,TECHnotes=!1,ARRscale="A,Bb,B,C,C#,D,Eb,E,F,F#,G,Ab,A,Bb,B,C,C#,D,Eb,E,F,F#,G,Ab,A,Bb,B,C,C#,D,Eb,E,F,F#,G,Ab".split(","),MSGlast="NO MESSAGE!",RAT=.7,SETlist="X",SETname="Single Tune",LOOPER=!1,LOOPtop=0,LOOPend=1e5,LOOPmode="played once",ENDscroll=!1,ENDaudio=!1,ARRtf="true,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false".split(","),PRESETno=-1,PRESET="Default Mode",BAR=0,BARalign=0,BARSTOP=0,ARRbars="".split(","),ARRpx="".split(","),LOG=640,ARRstatusLog="<pre><X2>=================DEBUG LOG=================</x2></pre>".split("@"),MSGcount=0,STATUSmon=1;function monitorBoot(){clearTimeout(TIMEOUTcrap),statusMonitor(2),statusMsg("User intiated boot monitor..."),start()}function start(){var e;j=0,clearTimeout(TIMEOUTcrap),document.getElementById("dubugSafety").focus(),statusMsg("Loading Javascript..."),revDates(),MSGlast="MSG ERROR",document.getElementById("revStatus").innerHTML="REV: "+REV,NONE=document.getElementById("none").style.display;for(var t="<a style='text-align:center; width:100%'><a style='color:white;'>SOUND MODE</a><br><select id='soundSelector' style='background-color:white;color:black;font-size:2vw; width:100%' onchange='setSoundModeDefault(this.value)'><optgroup>";j<ARRsoundModes.length;)t=t+"\n<option>"+ARRsoundModes[j]+"</option>",j++;t+="\n</optgroup></Select>",document.getElementById("soundBox").innerHTML=t,void 0===(e=receiveARR())|null===e|""===e?(BOOT=!0,createSetSelector()):(BOOT="edit",ARRtitle="INWORK,C,125,SILENT,No Note".split(","),createARRlines(e))}function createSetSelector(){statusMsg("Creating Set Selector...");var e=new XMLHttpRequest;e.open("GET","SetList.txt",!1),e.send(null);var t=e.responseText.split("\n"),n="<a style='text-align:center; width:45vw;color:white'>PLAYLIST:</a><br><select id='Set' style='font-size:2vw' onchange='SETname=(this.value);selectSet(this.value)'><optgroup>\n<option selected>ALL TUNES</option>";for(j=0;j<t.length;)"ALL TUNES"!==t[j]&&(n=n+"\n<option>"+t[j]+"</option>"),j+=1;n+="\n</optgroup></Select>",document.getElementById("setSelectA").innerHTML=n,selectSet("ALL TUNES")}function selectSet(e){var t=new XMLHttpRequest,n="../Sets/"+e+".txt";statusMsg("Selected Playlist: "+e,"yellow"),SETname=e,SETlist="",t.open("GET",n,!1),t.send(null),SETlist=t.responseText.split("\n"),dis("abet","ALL TUNES"==e?"block":"none"),createSetList()}function createSetList(){var e,t="<X2><optgroup>";for(statusMsg("Formating Playlist and Selecting Default Song...","yellow"),j=0;j<SETlist.length;)"@"==(e=SETlist[j].split("|")[0]).substring(0,1)&&(e=e.substring(1,e.length)),t=t+"\n<option value= '"+SETlist[j]+"'>"+e+"</option>",j++;t+="\n</optgroup></X2>",document.getElementById("mySet").innerHTML=t,TITLEplus=SETlist[TUNEnum=0],PREVtitle=TITLE=TITLEplus,selectTune(TITLEplus)}function nextTune(e){statusMsg(0&e,"yellow"),screenFormat("Think","transSubtract.png"),barSelect("none"),SETlist[TUNEnum+e]&&(TITLEplus=SETlist[TUNEnum+=e],document.getElementById("mySet").selectedIndex=TUNEnum),selectTune(TITLEplus)}function openSong(){var e=prompt("Please type the exact tune name",TITLE);statusMsg("User requested: "+e+" by exact title... ",0),null!==e&&selectTune(e)}function selectTune(e){statusMsg(e+": selected ...","lightgrey"),barSelect("none"),ARRtitle=(TITLEplus=e).split("|"),TITLE=ARRtitle[0],ALT="@"==ARRtitle[0].substr(0,1)?(ALT=!0,TITLE=ARRtitle[0].substr(1),!0):(TITLE=ARRtitle[0],!1),document.getElementById("myTune").innerHTML=TITLE,CTO(),document.getElementById("content").innerHTML="",SOUNDmode=void 0!==ARRtitle[3]&""!==ARRtitle[3]?ARRtitle[3]:SOUNDmodeDefault,void 0!==ARRtitle[4]&""!==ARRtitle[4]&&(NOTEset=ARRtitle[4]),TUNEnum=SETlist.indexOf(TITLEplus),loadServerTitle()}function loadServerTitle(){var e="../text/"+TITLE+".txt",t=new XMLHttpRequest;if(statusMsg("Downloading "+TITLE+"...","yellow"),KEYbase="X",document.getElementById("key2").innerHTML="-",document.getElementById("title").innerHTML=TITLE,TRANSPOSE=0,CTO(),ARRlines="",SCROLLend=!1,screenFormat("Think","transArrowDown"),t.open("GET",e,!1),t.send(null),0<(n=t.responseText).search("404")){var n="<center><X2>.......................Request Denied..........................</X2>\n\nNO FILE TITLED '"+TITLE+"'\n404 ERROR returned by Server\n(There may be a backing track!)</center>";statusMsg("Request for "+TITLE+" Denied!...",0)}createARRlines(n)}function createARRlines(e){for(statusMsg("Creating Song Array and Extracting Constants from Song File: "+TITLE,"yellow"),NOTEset=void 0,ARRlines="";0<=e.indexOf("\r");)e=e.replace("\r","");ARRlines=e.split("\n"),firstLineValues(),KEYlast=KEY,"X"==KEYbase&&(KEYbase=KEY),SETnoteViewed=NASH=!1,"edit"!==BOOT&&(void 0!==ARRtitle[1]&""!==ARRtitle[1]&&newKey(ARRtitle[1]),void 0!==ARRtitle[2]&""!==ARRtitle[2]&&(BPM=ARRtitle[2]),void 0!==ARRtitle[3]&""!==ARRtitle[3]&&(SOUNDmode=ARRtitle[3]),void 0!==ARRtitle[4]&""!==ARRtitle[4]&&(NOTEset=ARRtitle[4])),loadServerTrack()}function loadServerTrack(){rollMirror(!1),statusMsg("Loading mp3 track...",0);var e=1e3,t="",n=SOUNDicon="transSilent.png";document.getElementById("mirror").style.color="transparent",document.getElementById("mirrorImage").src="../../Icons/"+SOUNDicon,statusMsg("Cuing "+SOUNDmode+" mode with "+parseInt(e/1e3,10)+" sec delay...","yellow"),document.getElementById("Audio1").style.display="none";var o=BPM;if("SILENT"==SOUNDmode)document.getElementById("mirrorImage").src=document.getElementById("buttonTrack2").src="../../Icons/transSilent.png",n="transSilent.png",document.getElementById("Audio1").src="",durCalc();else{if("BACK TRACK"==SOUNDmode)BPM=hash(ARRlines[0],"BPM",BPM),n="transBackTrack.png",t="../Backing/"+TITLE+".mp3";else if("VOCAL"==SOUNDmode)BPM=hash(ARRlines[0],"BPM",BPM),n="transVocal.png",t="../VOCAL/"+TITLE+".mp3";else{for(;parseFloat(o/5,10)!==parseInt(o/5,10);)o=parseInt(o,10)+1;if(BPM=o,"CLICK TRACK"==SOUNDmode&&(n="transClick.png",t="../Click/"+BPM+".mp3"),2!=BEATS&4!=BEATS&8!=BEATS&16!=BEATS&"none.png"==n)return n="transTrackNo.png",document.getElementById("buttonTrack2").src="../../Icons/transTrackNo.png",AUDfail=!0,void durCalc();"DRUM ROCK"==SOUNDmode?(n="transRock.png",t="../DrumRock/"+BPM+".mp3"):"DRUM COUNTRY"==SOUNDmode?(n="transCountry.png",t="../DrumCountry/"+BPM+".mp3"):"DRUM COUNT"==SOUNDmode&&(e=500,n="transCount.png",t="../DrumCount/"+BPM+".mp3")}screenFormat("Think",SOUNDicon=n),document.getElementById("Audio1").src=t,Audio1.preload="auto";var s=setTimeout(function(){statusMsg("MP3 Duration:"+(DURmp3=document.getElementById("Audio1").duration),"green"),clearTimeout(s),!0===SOUND&&(document.getElementById("Audio1").volume=VOL),document.getElementById("V").innerHTML="<X2>"+parseInt(100*VOL,10)+"%</X2>",!1===isNaN(DURmp3)?(document.getElementById("Audio1").style.visibility="visible",AUDfail=!1):(DURmp3=0,color="red",AUDfail=!0,SOUNDicon="transTrackNo.png",statusMsg("Backtrack Audio Failed...",0)),document.getElementById("mirrorImage").src=document.getElementById("buttonTrack2").src="../../Icons/"+SOUNDicon,durCalc()},e)}}function durCalc(){statusMsg("Calculating Song Duration...","yellow"),DUR=DURcalc=0,DURsource="Undefined",countBARS(),DURcalc=parseInt(MEASURES*BEATS*60/BPM,10),0<DURtext&&(DUR=DURtext,DURsource="File"),0<DURcalc&&(DUR=DURcalc,DURsource="Calculation"),"BACK TRACK"==SOUNDmode|"VOCAL"==SOUNDmode&&!1===isNaN(DURmp3)&&(DUR=DURmp3,DURsource="MP3"),0===DUR&&(DUR="150",DURsource="Default"),DUR=parseInt(DUR,10),arrConvert()}function arrConvert(){statusMsg("Formatting Song and applying custom settings");var e,t,n,o,s,l,i,r,d,a,c,u,m=!1,E="",T=lyricLineCount(),g=0,R="";NOTEtrivia="NO TRIVIA NOTES",IRB=NOTElinks=NOTEtech=void(PRESONGlines=0),1==(LONGLINE=longestLine()+1)&&(LONGLINE=74,m=!0),!0===BREAKlines&&(LONGLINE=LINElimit),!0===LINEnum|!0===LINEtime&&(LONGLINE+=4);var I=1,p=!(NOTESpresent=!1);fsize=!0===TEXT?(t="/Small Text",165/LONGLINE):180/LONGLINE,e=fsize.toString(),FONTSIZE=e.substring(0,4)+"vw",n=(e=(BIGchordSize*fsize).toString()).substring(0,4)+"vw";var S=0;for(statusMsg("Line)Type/Actions================================",barCount=0);g<ARRlines.length;){if(t=g+") "+(s=lineType(o=ARRlines[g])),"irealb"==s)IRB=o,o=void 0;else if("hash"==s)o=void 0;else if("noteTriv"==s)"NO TRIVIA NOTES"==NOTEtrivia&&(NOTEtrivia=""),NOTEtrivia=NOTEtrivia+o.substr(2)+"<br>",NOTESpresent=!(o=void 0);else if("noteTech"==s)NOTEtech=void 0===NOTEtech?o.substr(3):NOTEtech+"\n"+o.substr(3),NOTESpresent=!(o=void 0);else if("note"==s)if(!0===p){for(PRESONGlines++,o=o.substring(1,o.length);o.length<LONGLINE;)o+=" ";o="<X2>"+o+"</X2>",!0!==LINEnum&&!0!==LINEtime||(o="<X6>    </X6>"+o)}else o=!0!==NOTES?void 0:"<X14>"+o+"</X14>";else if("link"==s)void 0===NOTElinks&&(NOTElinks=""),l=o.split("|"),NOTElinks=NOTElinks+"<u><a onclick =window.open('"+l[0]+"')>"+l[1]+"</a></u><br>",NOTESpresent=!(o=void 0);else if("chord"==s){if(t="<x2>"+t,p=!1,0!==TRANSPOSE)o=lineTranspose(o,TRANSPOSE),t=t+"/Transpose("+TRANSPOSE+")";else if(!0===BIGchords)for(t=t+"/Big Chords("+100*BIGchordSize+"%)",(r=(o=o.replace(/\s+/g,"")).split("|")).splice(0,1),S=BARSperLine,d=parseInt(LONGLINE/(S*BIGchordSize),10)-1,o="",e=0,r.length>S&&(d=parseInt(d*S/r.length,10));e<r.length;){for(i=r[e];i.length<=d;)i=i.replace(/~/g," ~"),i+=" ";o=o+"|"+i,e+=1}if(!0===BARsync){t+="/BarSync(";for(var L="",y=!(e=0);e<o.length;)"|"==o[e]?(!0===y?(L=L+"<a id='b"+barCount+'\' style="backgroundColor:transparent;">|',y=!1):L=L+"</a><a id='b"+barCount+'\' style="backgroundColor:transparent;">|',barCount++):L+=o[e],e++;for(;L.length<LONGLINE;)L+=" ";o=L+="               </a>",t=t+barCount+" Bars)</X2>"}o="<X100>"+o+"</X100>"}else if("header"==s){for(t="<x0>"+t+"========================================</X0>",!0===p&&(PRESONGlines+=2),p=!1,o=o.substring(1,o.length);o.length<LONGLINE-5;)o+="-";!0!==LINEnum&&!0!==LINEtime||(o="<X6>    </X6>"+o)}else if("lyric"==s){if(t="<X1>"+t,!0===BREAKlines){if(g+1<ARRlines.length){lineType(R=ARRlines[g+1]);"lyric"===lineType(R)&&(o+=R,g++)}o.length>LONGLINE&&(o.length>parseInt(2*LONGLINE,10)-5&&(WARNING="LYRIC LINES TOO LONG FOR SELECTED FONT >>> COMPLETE LINES MAY NOT BE DISPLAYED"),o=breakLine(o),t+="Split/")}!0===CAPS&&(o=o.toUpperCase(),t+="/Capitalized"),!0===LINEnum&&(o=(I<10?"<X5>"+I+"   </X5>":I<100?"<X5>"+I+"  </X5>":NaN+I+" </X5>")+o,I++),!0===LINEtime&&(o="<X5>"+secToMin((I-1)/T*DUR,10)+"</X5>"+o,I++),t+="</X1>"}else if("spacer"==s){for(!0===p&&(PRESONGlines+=1,t="/preSong"),o="."+o.substring(1,o.length);o.length<LONGLINE;)o+=" ";o="<X7>"+o+"</X7>",!0!==LINEnum&&!0!==LINEtime||(o="<X6>    </X6>"+o)}o&&(!0===LEFTborder&&(o="  "+o,t+="/Left-Space"),E=E+o+"\n"),statusMsg(t,0),g++}for(WINDht=window.innerHeight,WINDwt=window.innerWidth,RAT=parseFloat(WINDht/WINDwt),a=parseInt(100/fsize*RAT,10),c=parseInt(a/2-PRESONGlines,10),u="",g=0,u="<br><X4><center>"+TITLE.toUpperCase()+"</center></X4><br>";g<=c-3;)u+="<br>",g++;for(!0===m&&(E=E+"<img src='../Img/"+TITLE+".jpg' width='"+.98*WINDwt+"px'>"),E="<!DOCTYPE html><html><head><title id='title'>"+TITLE+"</title><style>\nBody{font-size : "+FONTSIZE+"; color:black; margin :0vh; padding: 0; font-family:Courrier New;font-weight:bold;line-height:100%;text-align:left;background-color:transparent;}"+"\nX99{color:red;font-size:"+n+";line-height:100%;}\n"+"\nX100{color:red;font-size:"+n+";line-height:100%;}\n</style></head><body>"+"<pre>"+u+E,offset2="",g=1;g<parseInt(a/2-1,10);)offset2+="<br>",g++;E=E+"<X2><center>=====    END    =====</center></X2>"+offset2+"</pre></body></html>",statusMsg("Line)Type/Actions================================",0),void 0!==NOTEtech&&(NOTEtech="<pre>"+NOTEtech+"</pre>"),opacSet("ButtonTrivia",""===NOTEtrivia|void 0===NOTEtrivia?.2:1),opacSet("ButtonTech",""===NOTEtech|void 0===NOTEtech?.2:1),opacSet("ButtonLinks",""===NOTElinks|void 0===NOTElinks?.2:1),opacSet("irbIcon",""===IRB|void 0===IRB?.2:1),document.getElementById("content").innerHTML=E,!1===m?scrollSetup():loadSongImage("../Img/"+TITLE+".jpg")}function loadSongImage(e){statusMsg("Loading Grapic Song Image...","yellow");var t=new Image;t.src=e,t.addEventListener("load",function(){scrollSetup()})}function scrollSetup(e){statusMsg("Setting Up Scroll...","yellow");var t="",n="grey";PAGEht=document.getElementById("content").clientHeight,document.getElementById("Tune").scrollTop=0,Ystart=0,Yend=!1,Ypos=document.getElementById("Tune").scrollTop,SCROLLpix=parseInt(PAGEht-WINDht,10),!0===isNaN(DUR)&&(DURsource=!(n="yellow")===isNaN(DURcalc)?(DUR=DURcalc,"Calculation"):!1===isNaN(DURtext)?(DUR=DURtext,"From File"):(DUR=150,"Default"),t="<X8>Audio available...</X8> "),SCROLLbase=SCROLLkon=1e3*DUR/SCROLLpix,document.getElementById("speed2").innerHTML=BPM,statusMsg("Applying Custom Settings...","yellow"),vis("volCtrl","SILENT"!==SOUNDmode?"visible":"hidden"),"Single Tune"==SETname&&(document.getElementById("title").innerHTML=TITLE),"Default"==DURsource&&(color="Yellow"),t=(t=t+"DURATION: "+secToMin(DUR)+" ("+DURsource+") [TIME "+BEATS+"/4]  {TUNE "+parseInt(TUNEnum+1,10)+" of "+SETlist.length+"}")+" {"+listChords()+"}",vis("clock",!0===CLOCK?"visible":"hidden"),void 0!==NOTEset&!1===SETnoteViewed&!0===SETnotes?notePopUp(TITLE+"<br>"+NOTEset.split("@").join("<br>"),"4vw","lightgray","purple","No Playlist Notes",void 0,"Playlist note..."):!0===POPnotes&PREVtitle!==TITLE?notePopUp(triviaNotes(),"2vw","black","yellow","No Trivia Notes...",0,"No Trivia Notes","Trivia Notes"):!0===TECHnotes&PREVtitle!==TITLE&void 0!==NOTEtech&&notePopUp(NOTEtech,"4vw","black","pink","No Tech Notes...",0,"Technical Notes"),PREVtitle=TITLE,TRANSPOSE=0,document.getElementById("key2").innerHTML=KEY,document.getElementById("V").innerHTML="<X2>"+parseInt(100*VOL,10)+"%</X2>",vis("shade",!0===SHADE?"visible":"hidden"),document.getElementById("thinkIcon").src="../../Icons/trans.png",LOOPend=SCROLLpix,document.getElementById("le").innerHTML=secToMin(DUR),LOOPtop=0,document.getElementById("lt").innerHTML="0:00",!0===ALT&&(document.getElementById("altSong").innerHTML=SETlist[TUNEnum+1].split("|")[0]),screenFormat("Ready"),document.getElementById("splash").style.display="none",document.getElementById("msg").style.top="0%",!0===BOOT&&(dis("configuration","block"),BOOT=!1,window.innerHeight>=window.innerWidth&&alert("Rotate your device..."),1===STATUSmon?(t="Select your Sound Mode > Select your Playlist > Set your Configuration",n="yellow",statusMonitor(0)):2===STATUSmon&&(t="Boot Successful, You're in the Debug mode...",n="red"),"edit"==BOOT&&(t="SONG PASSED FROM THE EDITOR!!!  REMEMBER TO SAVE IT THERE!!!",n="red")),rollMirror(!0),"No Warnings!"!==WARNING&&(t=WARNING,n="red",WARNING="No Warnings!"),BAR=-1,BARSTOP=ARRbars[0],ENDaudio=ENDscroll=!1,statusMsg(t,n)}function trackPrePlay(){statusMsg("Pre-Play...",0),trackPlay()}function scrollEngine(){var e;!0===ENDaudio&!0===ENDscroll&&(statusMsg("shit"),endSong()),!0===SCROLLend&&0===DURmp3|!0===isNaN(document.getElementById("Audio1").duration)|document.getElementById("Audio1").currentTime>=document.getElementById("Audio1").duration&&(ENDaudio=!0,statusMsg("Audio finished or inactive",0)),Ypos===document.getElementById("Tune").scrollTop&&SS++,!0===BARsync&&(Ypos<=1?document.getElementById("b0").style.backgroundColor="yellow":BARSTOP<Ypos/SCROLLpix*DUR&BAR<ARRbars.length&&(statusMsg("<X0>BAR:"+BAR+" ended ("+BARSTOP+" sec of "+DUR+" sec)</X0>",0),BARSTOP=ARRbars[BAR+=1]/MEASURES*DUR,document.getElementById("b"+BAR).style.backgroundColor="yellow",document.getElementById("b"+parseInt(BAR-1,10)).style.backgroundColor="transparent")),5<SS|document.getElementById("Tune").scrollTop>SCROLLpix-2?(ENDscroll=!0,statusMsg("Scroll Complete....",0),endSong()):(SS=0,nowTime=(new Date).getTime(),e=parseInt((nowTime-SCROLLstartTime)/SCROLLkon+Ystart,10),document.getElementById("Tune").scrollTop=e,Ypos=document.getElementById("Tune").scrollTop,statusMsg("> "+parseInt(Ypos,10)+" px",0),TIMEOUTscroll=setTimeout(function(){scrollEngine()},SCROLLkon))}function scrollEngineSAVE(){var e;!1===ENDaudio&&0===DURmp3|!0===isNaN(document.getElementById("Audio1").duration)|document.getElementById("Audio1").currentTime>=document.getElementById("Audio1").duration&&(ENDaudio=!0,statusMsg("Audio finished or inactive",0)),!0===ENDaudio&!0===ENDscroll?endSong():((Ypos=document.getElementById("Tune").scrollTop)==TOPlast?SS++:(SS=0,TOPlast=Ypos),5<SS|document.getElementById("Tune").scrollTop>SCROLLpix-2&&(statusMsg("Scroll END (SS="+SS+") at "+document.getElementById("Tune").scrollTop+" END AUDIO ="+ENDaudio+")",0),ENDscroll=!0,"BACK TRACK"!=SOUNDmode&"VOCAL"!=SOUNDmode&&(ENDaudio=!0,trackPause(),screenFormat("End"))),!0===BARsync&&(Ypos<=1?document.getElementById("b0").style.backgroundColor="yellow":Audio1.currentTime>BARSTOP&BAR<ARRbars.length|BARSTOP<Ypos/SCROLLpix*DUR&BAR<ARRbars.length&&(statusMsg("<X0>BAR:"+BAR+" ended ("+BARSTOP+" sec of "+DUR+" sec)</X0>",0),BARSTOP=ARRbars[BAR+=1]/MEASURES*DUR,document.getElementById("b"+BAR).style.backgroundColor="yellow",document.getElementById("b"+parseInt(BAR-1,10)).style.backgroundColor="transparent")),nowTime=(new Date).getTime(),e=parseInt((nowTime-SCROLLstartTime)/SCROLLkon+Ystart,10),document.getElementById("Tune").scrollTop=e,statusMsg("> "+parseInt(Ypos,10)+" px",0),TIMEOUTscroll=setTimeout(function(){scrollEngine()},SCROLLkon))}function endSong(){statusMsg("ENDING SONG & CLEANING UP...",0),CTO(),Audio1.pause();var e=document.getElementById("Audio1").duration,t=document.getElementById("Tune").scrollTop,n=document.getElementById("Audio1").currentTime;statusMsg("Scroll:"+parseInt(100*t/SCROLLpix,10)+"%  Time:"+parseInt(100*n/e,10)+"%",0),screenFormat("End")}function notePopUp(e,t,n,o,s,l,i){document.getElementById("cloudX").style.color=n,document.getElementById("cloudX").style.backgroundColor=o,document.getElementById("cloudX").style.fontSize=t,document.getElementById("cloudX").innerHTML=e,document.getElementById("cloudX").scrollTop=0,document.getElementById("cloudTitle").innerHTML=l,document.getElementById("cloudX").scrollTop=0,dis("information","block"),statusMsg("Pop Up Notes : "+l,0)}function CTO(){statusMsg("Clearing 'TIMEOUTS'",0),clearTimeout(TIMEOUTdelay),clearTimeout(TIMEOUTscroll),clearTimeout(TIMEOUTnext),clearTimeout(TIMEOUTfade),clearTimeout(TIMEOUTwait),clearTimeout(TIMEOUTintro)}function scrollTune(e,t){var n=parseInt(e*WINDht/25,10),o=Math.abs(parseInt(100*e,10)),s=document.getElementById("Tune").scrollTop;void 0===t?(t=1,clearTimeout(TIMEOUTscroll)):t+=1,t<o&0<s?TIMEOUTscroll=setTimeout(function(){document.getElementById("Tune").scrollTop=s+n,scrollTune(e,t)},36):(statusMsg("Scrolled "+parseInt(100*e,10)+"% in "+t+" steps",0),clearTimeout(TIMEOUTscroll),Ystart=document.getElementById("Tune").scrollTop,SCROLLstartTime=(new Date).getTime(),statusMsg("Starting Scroll Engine",0),scrollEngine())}function screenFormat(e,t){statusMsg("Display Format: "+e,0),"DelayedPlay"==e|"Scroll"==e|"Ready"==e|"Pause"==e|"Think"==e|"End"==e?(clearTimeout(TIMEOUTfade),dis("Audio1","none"),dis("bigButtons","none"),dis("bigPlay","block"),dis("think","none"),dis("backDrop","none"),dis("altSong","none"),dis("msg","none"),dis("lastIcon","block"),dis("nextIcon","block"),vis("cntDwn","hidden"),vis("fadeIcon","hidden"),"DelayedPlay"==e&&(vis("cntDwn","visible"),dis("think","block"),document.getElementById("shade").style.visibility="hidden",barSelect("none"),dis("songIcons","none"),dis("msg","block")),"Scroll"==e&&(dis("bigButtons","block"),dis("bigPlay","none"),dis("bigReset","none"),barSelect("none"),dis("songIcons","none"),document.getElementById("shade").style.visibility="hidden",!0===BACKdrop&&dis("backDrop","block")),"Ready"===e&&(!0===ALT&&dis("altSong","block"),dis("bigButtons","none"),dis("bigPlay","block"),dis("bigReset","block"),dis("songIcons","block"),dis("msg","block"),dis("Audio1","block")),"End"===e&&(dis("bigButtons","none"),dis("bigPlay","block"),dis("bigReset","block"),dis("songIcons","block"),statusMsg(TITLE+" has ended...","yellow"),dis("msg","block"),dis("Audio1","block")),"Pause"===e&&(dis("bigButtons","none"),dis("bigPlay","block"),dis("bigReset","block"),dis("songIcons","block"),dis("Audio1","block"),dis("msg","block")),"Think"===e&&(void 0===t&&(t="transClear.png"),document.getElementById("thinkIcon").src="../../Icons/"+t,dis("think","block")),0===TUNEnum&&dis("lastIcon","none"),TUNEnum>SETlist.length-2&&dis("nextIcon","none")):alert(e+" is an invalid Command")}function scrollRate(e){BPM<350&e<1|30<BPM&1<e&&(SCROLLkon*=e,statusMsg("Changed Scroll Rate by "+e+"% from: "+BPM+" to: "+(BPM=parseInt(BPM*(SCROLLbase/SCROLLkon),10)),0),showSetting(1),SCROLLstartTime=(new Date).getTime(),Ystart=Ypos,Ypos=document.getElementById("Tune").scrollTop)}function trackDelay(){clearTimeout(TIMEOUTintro),document.getElementById("cntDwn").style.color="black",document.getElementById("cntDwn").style.visibility="visible",statusMsg("START  SONG  WHEN  THE  SCROLL ROLLS!!","yellow"),screenFormat("DelayedPlay"),!1===COUNTin&&trackPlay(),"DRUM COUNT"==SOUNDmode?(document.getElementById("Audio1").play(),TIMEOUTintro=setTimeout(function(){trackPlay()},1e3*document.getElementById("Audio1").duration)):countIn(0)}function countIn(e){var t=parseInt(6e4/BPM,10);BEATS<e?(clearTimeout(TIMEOUTintro),document.getElementById("cntDwn").innerHTML="",document.getElementById("cntDwn").style.visibility="hidden",trackPlay()):TIMEOUTintro=setTimeout(function(){!0===CLICKER&&document.getElementById("aC").play(),e=parseInt(e+1,10),document.getElementById("cntDwn").innerHTML=e,document.getElementById("cntDwn").style.visibility="visible",countIn(e)},t)}function trackPause(){CTO(),!0===BARsync&&barsClear(),"SILENT"!==SOUNDmode&&document.getElementById("Audio1").pause(),!0!==LOOPER|document.getElementById("Tune").scrollTop<LOOPend?statusMsg("Paused...","yellow"):statusMsg("Loop Paused!","yellow"),screenFormat("Pause")}function trackPlay(){statusMsg("trackPlay: "+SOUNDmode,0),ENDscroll=!1,Audio1.pause(),CTO(),!0===BARsync?findBar():trackAlign("Screen"),screenFormat("Scroll"),Ystart=document.getElementById("Tune").scrollTop,SCROLLstartTime=(new Date).getTime(),3<document.getElementById("Audio1").duration&&document.getElementById("Audio1").play(),statusMsg("Playing in "+SOUNDmode+" Mode...",0),scrollEngine()}function findBar(){var e=0;for(i=0;e<document.getElementById("Tune").scrollTop;)e=ARRbars[i]*SCROLLpix/MEASURES,i++;document.getElementById("Tune").scrollTop=e,trackAlign("SILENT"===SOUNDmode|"BACK TRACK"===SOUNDmode|"VOCAL"===SOUNDmode?"Screen":"Free"),BAR=i,BARSTOP=ARRbars[i]/MEASURES*DUR,document.getElementById("b"+BAR).style.backgroundColor="yellow",statusMsg("<X2>findBar()=BAR:"+i+" BARSTOP: "+BARSTOP+"</X2>",0)}function trackAlign(e){var t,n,o;"Scroll"===e?(statusMsg("DURmp3 "+DURmp3,0),t=parseFloat(document.getElementById("Tune").scrollTop/SCROLLpix,10),statusMsg("trackPos "+(n=parseFloat(t*DURmp3,10)),0),document.getElementById("Audio1").currentTime=n,statusMsg("Audio aligned to SCROLL "+scrollPct+"%",0)):"Audio"===e?(t=parseFloat(document.getElementById("Audio1").currentTime/DURmp3,10),o=parseFloat(t*SCROLLpix,10),document.getElementById("Tune").scrollTop=o,statusMsg("Scroll aligned to Audio at "+t+"%",0)):"Screen"===e?(t=document.getElementById("Tune").scrollTop/SCROLLpix,document.getElementById("Audio1").currentTime=parseFloat(t*DURmp3,10),statusMsg("Scroll and Audio aligned to SCREEN at "+t+"% /"+parseFloat(t*DURmp3,10)+"sec",0)):"Free"===e&&statusMsg("Scroll and Audio aligned to SCREEN at "+(t=document.getElementById("Tune").scrollTop/SCROLLpix)+"%",document.getElementById("Audio1").currentTime=0)}function countIn2(e){var t=parseInt(6e4/BPM,10);BEATS<e?(clearTimeout(TIMEOUTintro),document.getElementById("cntDwn").innerHTML="",document.getElementById("cntDwn").style.visibility="hidden",trackPlay()):TIMEOUTintro=setTimeout(function(){!0===CLICKER&&document.getElementById("aC").play(),e=parseInt(e+1,10),document.getElementById("cntDwn").innerHTML=e,document.getElementById("cntDwn").style.visibility="visible",countIn(e)},t)}function trackReset(){statusMsg("Resetting "+TITLE),AUDIOend=SCROLLend=!1,ALT=!1,document.getElementById("Audio1")&&(document.getElementById("Audio1").autoplay=!1,document.getElementById("Audio1").load(),!0===SOUND&&(document.getElementById("Audio1").volume=VOL)),document.getElementById("Tune").scrollTop=LOOPtop,!(BAR=0)===BARsync&&barsClear(),!0===LOOPER?(document.getElementById("Audio1").currentTime=parseInt(SCROLLkon*LOOPtop/1e3,10),statusMsg("Loop reset to "+secToMin(parseInt(SCROLLkon*LOOPtop/1e3,10)),"orange")):statusMsg(TITLE+" reset..."),screenFormat("Ready"),CTO()}function fadeAudio(){var e=.75*document.getElementById("Audio1").volume;statusMsg("Fading Audio> "+100*e+"%",0),(document.getElementById("Audio1").volume=e)<=.01?(clearTimeout(TIMEOUTfade),document.getElementById("Audio1").pause(),ENDaudio=!0,statusMsg("<X2>Audio Paused and Volume reset to "+100*(document.getElementById("Audio1").volume=VOL)+"%</X2>",0)):(document.getElementById("Audio1").volume=e,setTimeout(function(){fadeAudio()},200))}function fade(e){if(!0===SOUND){var t,n=document.getElementById("Audio1").volume;document.getElementById("V").innerHTML="<X2>"+parseInt(100*VOL,10)+"%</X2>","x"===e&&(e=0<VOL&0<n?"down":"up"),"up"==e&n<VOL|"down"===e&.01<n?(vis("fadeIcon","visible"),TIMEOUTfade=setTimeout(function(){t="down"==e?.7:1.3,0===document.getElementById("Audio1").volume&&(n=.005),1<(t*=n)&&(t=1),document.getElementById("Audio1").volume=t,fade(e),document.getElementById("V").innerHTML="<X2>Fade</X2>"},1e3)):(vis("fadeIcon","visible"),clearTimeout(TIMEOUTfade),"down"==e&&(document.getElementById("Audio1").volume=0,n=0),"up"==e&&(document.getElementById("Audio1").volume=VOL,n=VOL),document.getElementById("V").innerHTML="<X2>"+parseInt(100*VOL,10)+"%</X2>")}}function blinker(e,t){var n=document.getElementById(e);0<t?("visible"==n.style.visibility?n.style.visibility="hidden":n.style.visibility="visible",TIMEOUTblink=setTimeout(function(){clearTimeout(TIMEOUTblink),blinker(e,t-=1)},125)):(clearTimeout(TIMEOUTblink),n.style.visibility="visible")}function unique(e){var t,n={},o=[],s=e.length;for(t=0;t<s;++t)n[e[t]]=null;for(t in n)o.push(t);return o}function flash(e,t){if(e!==MSGlast){var n=MSGlast;void 0===t&&(t=3),t=parseInt(1e3*t,10),statusMsg(e,"red"),setTimeout(function(){statusMsg(n)},t)}}function resetLoop(){screenFormat("Think"),TIMEOUTscroll=setTimeout(function(){statusMsg("Resetting....","orange"),Ypos=document.getElementById("Tune").scrollTop-(1+parseInt((LOOPend-LOOPtop)/50,10)),(document.getElementById("Tune").scrollTop=Ypos)<=LOOPtop?(document.getElementById("Tune").scrollTop=Ypos=LOOPtop,document.getElementById("Audio1").currentTime=parseInt(SCROLLkon*LOOPtop/1e3,10),statusMsg("Starting Loop....","orange"),CTO(),TIMEOUTscroll=setTimeout(function(){trackPlay()},2e3)):resetLoop()},1)}function endLoop(){screenFormat("Ready"),CTO(),statusMsg("Loop Complete...","yellow"),"repeated"==LOOPmode&&(trackPause(),TIMEOUTscroll=setTimeout(function(){resetLoop()},2e3))}function loopMode(){document.getElementById("loopImg").src="repeated"==LOOPmode?(LOOPmode="played once","../../Icons/transOnePlay.png"):(LOOPmode="repeated","../../Icons/transInfinity.png"),loopMsg()}function loopMsg(e){var t="Loop Start: "+secToMin(LOOPtop*SCROLLkon/1e3)+"......Loop End: "+secToMin(LOOPend*SCROLLkon/1e3)+"......"+LOOPmode+"!";"true"==e?alert(t):statusMsg(t,"yellow")}function loopMarkTop(){LOOPtop=document.getElementById("Tune").scrollTop,loopMsg(),document.getElementById("lt").innerHTML=secToMin(LOOPtop*SCROLLkon/1e3)}function loopMarkEnd(){LOOPend=document.getElementById("Tune").scrollTop,loopMsg(),document.getElementById("le").innerHTML=secToMin(LOOPend*SCROLLkon/1e3)}function showSetting(e){statusMsg("Displaying key, tempo or track type",0),document.getElementById("mirrorImage").src=2<e?(document.getElementById("mirror").style.color="transparent",document.getElementById("buttonTrack2").src="../../Icons/"+SOUNDicon):(document.getElementById("mirror").style.color="black","../../Icons/transCircleWhite.png"),0===e?document.getElementById("key2").innerHTML=document.getElementById("mirror").innerHTML=KEY:document.getElementById("speed2").innerHTML=document.getElementById("mirror").innerHTML=BPM}function listTempos(){var e,t,n,o,s,l=0,i="",r=o;if("BACK TRACK"==SOUNDmode|"VOCAL"==SOUNDmode)i="You cannot change the Tempo of<br>Pre-recorded VOCAL OR BACKING TRACK...";else{for("SILENT"==SOUNDmode|!0===AUDfail?(e=50,t=300,n=5):"DRUM ROCK"==SOUNDmode|"DRUM COUNT"==SOUNDmode?(e=70,t=220,n=5):"CLICK TRACK"==SOUNDmode?(e=70,t=190,n=5):"DRUM COUNTRY"==SOUNDmode?(e=70,t=220,n=10):alert("UNKNOWN ERROR SOUND MODE "+SOUNDmode+" DOES NOT EXIST!"),o=e,l=0;o<BPM;)o+=n,l++;for(i="<br><a onclick = 'setBPM("+o+")' style='color:red'>"+o+"</a><br>",l=1;l<=10;)(r=o+l*n)<=t&&(i="<a onclick = 'setBPM("+r+");SONGlastCustom=1;showSetting(1);'> "+r+"</a>-"+i),e<=(s=o-l*n)&&(i=i+"<a onclick = 'setBPM("+s+");SONGlastCustom=1;showSetting(1);'> "+s+"</a>-"),l+=1}document.getElementById("tempo2").innerHTML=i}function newKey(e){var t,n=e,o=!1,s=0;if("N"!=KEY){for("#"==n.substring(1,2)&&(n=n.substring(0,1)+"s"),"N"==e&&(o=!0,e="A");ARRscale[s]!==KEY;)s++;for(t=s;ARRscale[t]!==e;)t++;TRANSPOSE=t-s,!1!==o&&(e="N"),document.getElementById("key2").src="../../Icons/Key"+n+".png",KEYlast=KEY,statusMsg("Transposed to "+(KEY=e),0),arrConvert()}else alert("Not Programed to transpose From Nashville Notation\nSimply move to another song and back to clear Nashville Notation!\n SORRY...")}function setBPM(e){"SILENT"==SOUNDmode?(BPM=e,durCalc()):(BPM=e,showSetting(1),loadServerTrack()),listTempos(),statusMsg("Set BPM to "+e,0)}function setSoundModeDefault(e){var t=ARRsoundModes.indexOf(e);document.getElementById("soundSelector").selectedIndex=t,SOUNDmodeDefault=SOUNDmode=e,!1===BOOT&&selectTune(TITLEplus)}function setSoundMode(e,t){statusMsg("Sound mode: "+e+">>>>"+SOUNDicon),showSetting(2),SOUNDmode=e,loadServerTrack()}function presets(e){"presets2"===e&&statusMsg("<X2>Wraping up "+PRESET+"...</X2>",0),"Default Mode"===PRESET?(ARRtf="true,false,false,true,false,false,false,false,false,false,false,false,false,true,false,false,false".split(","),"presets2"===e&&(setLineLimit(80),selectSet("ALL TUNES"))):"Perform Mode"===PRESET?(ARRtf="false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false".split(","),"presets2"===e&&(setLineLimit(50),selectSet("Fred on his own"))):"Practice Mode"===PRESET?(ARRtf="false,true,false,true,false,false,false,true,false,false,true,true,true,true,true,true,false".split(","),"presets2"===e&&(setLineLimit(55),selectSet("ALL TUNES"))):"Developer Mode"===PRESET&&(ARRtf="true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false".split(","),"presets2"===e&&(selectSet("Test"),statusMonitor(2),setLineLimit(50),document.getElementById("mySet").selectedIndex=0,selectTune("Abilene"))),PRESETno=0,"presets"===e?(statusMsg("<X2>"+PRESET+" selected by the user...\n----------------------------------------</X2>",0),setCustom("-","-","presets")):"presets2"===e&&statusMsg("<X2>---------------------------------------------\n"+PRESET+" Configuration is Set...</X2>",0)}function setCustom(e,t,n){var o;if(void 0===n|null===n|""===n|" "===n)return n="ERROR",void statusMsg("ERROR...Process Program Terminated");"presets"===n?statusMsg("    "+(e=ARRpresets[PRESETno])+" to "+(t=!!("true"===ARRtf[PRESETno]|!0===ARRtf[PRESETno]))+"  "+parseInt(PRESETno+1,10)+" of "+ARRpresets.length,0):"refresh"===n&&(!0===window[e]?t=!1:!1===window[e]&&(t=!0),statusMsg("Reflex Change of "+e+" to "+t+"\n======================================",0)),o=!0===t?"ON.png":"OFF.png",window[e]=t,document.getElementById("img"+e).src="../../Icons/"+o,"presets2"!==n?("BREAKlines"==e&&(!0===BREAKlines&&(statusMsg(e+": forcing BIG chords to true "+n,0),BIGchords=!0,document.getElementById("imgBREAKlines").style.width="16%",document.getElementById("imgBREAKlines").src="../../Icons/ON.png",document.getElementById("breakLines").style.width="16%",document.getElementById("breakLines").innerHTML="CHR/<br>Line",document.getElementById("bcp").innerHTML="Size<br>Chords",document.getElementById("bcp").style.width="16%",document.getElementById("imgBIGchords").style.width="16%",document.getElementById("imgBIGchords").src="../../Icons/ON.png"),vis("bigChordPct","visible")),!1===BREAKlines&&(document.getElementById("imgBREAKlines").style.width="32%",document.getElementById("breakLines").style.width="32%",document.getElementById("breakLines").innerHTML="Characters<br>Per Line"),"BIGchords"==e&&(!0===BIGchords?(document.getElementById("imgBIGchords").style.width="16%",document.getElementById("bcp").innerHTML="Size<br>Chords",document.getElementById("imgBIGchords").src="../../Icons/ON.png",document.getElementById("bcp").style.width="16%"):(statusMsg("--Custom E: "+e+": forcing BREAKlines to false "+n,0),document.getElementById("imgBIGchords").style.width="32%",document.getElementById("bcp").innerHTML="Spread & Size<br>Chords",document.getElementById("bcp").style.width="32%",BREAKlines=!1,document.getElementById("breakLines").innerHTML="Characters<br>Per Line",document.getElementById("breakLines").style.width="32%",document.getElementById("imgBREAKlines").src="../../Icons/OFF.png",document.getElementById("imgBREAKlines").style.width="32%")),"SETnotes"==e&!0===SETnotes&&(document.getElementById("imgPOPnotes").src="../../Icons/OFF.png",POPnotes=!1,document.getElementById("imgTECHnotes").src="../../Icons/OFF.png",TECHnotes=!1),"POPnotes"==e&!0===POPnotes&&(document.getElementById("imgSETnotes").src="../../Icons/OFF.png",SETnotes=!1,document.getElementById("imgTECHnotes").src="../../Icons/OFF.png",TECHnotes=!1),"TECHnotes"==e&!0===TECHnotes&&(document.getElementById("imgSETnotes").src="../../Icons/OFF.png",SETnotes=!1,document.getElementById("imgPOPnotes").src="../../Icons/OFF.png",POPnotes=!1),"LINEnum"==e&!0===LINEnum&&(window[LINEtime]=!1,document.getElementById("imgLINEtime").src="../../Icons/OFF.png",LINEtime=!1),"LINEtime"==e&!0===LINEtime&&(window[LINEnum]=!1,document.getElementById("imgLINEnum").src="../../Icons/OFF.png",LINEnum=!1),"FULLscreen"==e&&(!0===FULLscreen?launchIntoFullscreen(document.documentElement):exitFullscreen()),"CLOCK"===e&&("presets"===n?(CLOCK=!1,statusMsg("<X2>CLOCK IS FALSE due to code problem</X2>")):!0===CLOCK?(statusMsg("problem",0),clockRun()):(clearTimeout(TIMEOUTclock),dis("clock","none"))),"LOOPER"==e&&(document.getElementById("looper").style.visibility=!0===LOOPER?"visible":"hidden"),"TEXT"==e&&(document.getElementById("imgTEXT").src=!0===TEXT?"../../Icons/On.png":"../../Icons/OFF.png"),"CLICKER"==e&&!0===CLICKER&&(document.getElementById("imgCOUNTin").src="../../Icons/On.png",COUNTin=!0),"COUNTin"==e&&!1===COUNTin&&(document.getElementById("imgCLICKER").src="../../Icons/OFF.png",CLICKER=!1),"presets"===n?PRESETno>=parseInt(ARRpresets.length-1,10)?presets("presets2"):(PRESETno+=1,setCustom("","","presets")):"refresh"===n?arrConvert():"click"===n?document.getElementById("aC").play():statusMsg("A-6OUT")):alert(2)}function launchIntoFullscreen(e){e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}function exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():element.msCancelFullscreen&&document.msCancelFullscreen()}function tgl(e,t){t?window[e]=t:!0===window[e]?window[e]=!1:window[e]=!0,!0===window[e]?document.getElementById("img"+e).src="../../Icons/On.png":document.getElementById("img"+e).src="../../Icons/OFF.png"}function togl(e){tgl(e),"LINEtime"==e&&!0===LINEnum?tgl("LINEnum",!1):"LINEnum"==e&&!0===LINEnum&&tgl("LINEtime",!1)}function volSet(e){var t;if(clearTimeout(TIMEOUTfade),vis("fadeIcon","visible"),10==e&!0===SOUND)SOUND=!1,document.getElementById("Audio1").volume=0,document.getElementById("soundOO").src="../../Icons/Off.png",document.getElementById("V").innerHTML="<X2>OFF</X>";else if(10==e&&(SOUND=!0,e=0,document.getElementById("soundOO").src="../../Icons/ON.png"),(t=parseInt(VOLexp+e,10))<5&&-1<t){VOLexp=t,VOL=Math.pow(.71,4-VOLexp);var n=parseInt(15+15*VOLexp,10)+"%";document.getElementById("SK").style.bottom=n;var o=parseInt(15*t,10)+"%";document.getElementById("SUp").style.height=o}document.getElementById("V").innerHTML="<X2>"+parseInt(25*t,10)+"%</X2>",!0===SOUND?document.getElementById("Audio1").volume=VOL:document.getElementById("V").innerHTML="<X2>OFF</X2>"}function revDates(){var e=new XMLHttpRequest;e.open("HEAD",JSname,!1),e.send(null),JSdate=e.getResponseHeader("Last-Modified"),HTMLdate=document.lastModified}function revDetails(){statusMsg("REVISION: "+REV+" <> HTML: "+document.lastModified+" <> JavaScript: "+JSdate,"blue")}function indexLetter(e){var t=0;document.getElementById("mySet").selectedIndex=t;for(var n=document.getElementById("mySet").value;n.substring(0,1)!==e;){document.getElementById("mySet").selectedIndex=t;n=document.getElementById("mySet").value;if(t++,document.getElementById("mySet").value,t==document.getElementById("mySet").length-1)return void statusMsg("No Tunes Starting with "+e,"yellow")}selectTune(document.getElementById("mySet").value)}function changeBackgroundImage(e,t){var n="url("+t+")";document.getElementById(e).style.backgroundImage=n}function bcPct(e){void 0!==e?BIGchordSize=1:BIGchordSize+=.25,2.25==BIGchordSize&&(BIGchordSize=1),1.75==BIGchordSize&&(BIGchordSize=2),document.getElementById("bigChordPct").innerHTML=100*BIGchordSize+"%",arrConvert()}function lineTranspose(e,t){var n;if(0===t)n=e;else{var o="",s="",l=0;n="";for(var i=0;i<e.length;){if(" "==e[i])if(0===s.length)0<l?l=parseInt(l-1,10):n+=" ";else{if((l+=(o=chordTranspose(s,t)).length-s.length)<0)for(;l<0;)l+=1,o+=" ";n=n+o+" ",o=s=""}else s+=e[i],i==e.length-1&&(n+=chordTranspose(s,t));i+=1}}return n}function chordTranspose(e,t){var n="";if(0===t)n=e;else{var o=0;for(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/A#/g,"Bb")).replace(/B#/g,"C")).replace(/Cb/g,"B")).replace(/Db/g,"C#")).replace(/D#/g,"Eb")).replace(/Fb/g,"E")).replace(/E#/g,"F")).replace(/Gb/g,"F#")).replace(/G#/g,"Ab"),o=0;o<e.length;){var s=1;"A"==e[o]|"B"==e[o]|"C"==e[o]|"D"==e[o]|"E"==e[o]|"F"==e[o]|"G"==e[o]?o<e.length-1&&"#"==e[o+1]|"b"==e[o+1]?(n+=noteTranspose(e[o]+e[o+1],t),s=2):n+=noteTranspose(e[o],t):n+=e[o],o+=s}}return n}function noteTranspose(e,t){var n="?",o="A,Bb,B,C,C#,D,Eb,E,F,F#,G,Ab,A,Bb,B,C,C#,D,Eb,E,F,F#,G,Ab,A,Bb,B,C,C#,D,Eb,E,F,F#,G,Ab".split(",");for(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/A#/g,"Bb")).replace(/B#/g,"C")).replace(/Cb/g,"B")).replace(/Db/g,"C#")).replace(/D#/g,"Eb")).replace(/Fb/g,"E")).replace(/E#/g,"F")).replace(/Gb/g,"F#")).replace(/G#/g,"Ab"),i=13;i<38&&o[i]!=e;i++);return n=o[i+t],"N"==KEY&&(n="A"==n?"1":"Bb"==n?"2b":"B"==n?"2":"C"==n?"3b":"C#"==n?"3":"D"==n?"4":"Eb"==n?"5b":"E"==n?"5":"F"==n?"6b":"F#"==n?"6":"G"==n?"7b":"Ab#"==n?"7":"??"),n}function printContent(){var e=document.getElementById("content").innerHTML;e="<X100>"+TITLE+"<br>"+listChords()+"</X100><br>"+e.replace(/<br>/g,""),window.open("","Title","toolbar=yes,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes").document.body.innerHTML=e}function notes(){window.open(encodeURI("notes.html?"+encodeFredComponent(ARRlines.join("\n"))+"?"+encodeFredComponent(TITLE)))}function home(){window.open("index.html")}function history(){window.open("player.txt")}function iRealLink(){1==confirm("ifthis computer has Ireal Pro installed press OK.\n Otherwise; Cancel this operation to see the Ireal Text file.")&&window.open(IRB)}function fileMaster(){window.open("FileMaster.html")}function analizeSong(){var e="TITLE: "+TITLE+" (SOUND MODE: "+SOUNDmode+")";return e=(e=(e=(e=(e=(e=(e=(e=(e=e+"<br>PLAYLIST: "+SETname+"<br>=======================")+"<br>KEY: "+KEYbase+" (Transposed to "+KEY+")")+"<br>TIME SIG: "+BEATS+"<br>MEASURES : "+MEASURES+"<br>BARS: "+BARS+" (half Bars:"+BARShalf+")<br>TEMPO: "+BPM+" BPM<br>QUALITY: "+QUAL)+"<br>GENRE: "+GENRE+"<br>STYLE: "+STYLE+"<br>ARTIST: "+ARTIST)+"<br>HIT YEAR: "+HITyear)+"<br>======================<br>DURATION: "+DUR+" ("+secToMin(DUR)+")<br>DUR SOURCE: "+DURsource)+"<br>   DUR CALC: "+DURcalc+" ("+secToMin(DURcalc)+") 100%")+"<br>   DUR FILE: "+DURtext+" ("+secToMin(DURtext)+")"+parseInt(100*DURtext/DURcalc,10)+"%")+"<br>   DUR MP3: "+parseInt(DURmp3,10)+" ("+secToMin(DURmp3)+")"+parseInt(100*DURmp3/DURcalc,10)+"%",e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e+="<br>======================<br>TECHNICAL INFO")+"<br>   ASPECT RATIO: "+parseFloat(1/RAT))+"<br>   LONGEST LINE: "+LONGLINE+" charcters")+"<br>   PRE-SONG LINES: "+PRESONGlines+" lines")+"<br>   CHORD LINES: "+CHORDlines+" lines")+"<br>   WINDOW HT: "+WINDht+"px ("+parseInt(100*WINDht/PAGEht,10)+")%")+"<br>   DOCUMENT HT: "+PAGEht+"px")+"<br>   SCROLL PIX: "+SCROLLpix+"px")+"<br>   WINDOW WT: "+WINDwt+"px")+"<br>   SCROLL RATE: "+parseInt(SCROLLkon,10)+" micro-sec/pixel")+"<br>   SCROLL POSITION: "+document.getElementById("Tune").scrollTop+"px")+"<br>======================<br>CHORDS<br>"+listChords()+"<br>=======================================END=======================================<br>"}function lyricLineCount(){for(var e=0,t=0;t<ARRlines.length;)"lyric"==lineType(ARRlines[t])&&e++,t++;return e}function getRevisonHistory(){var e=new XMLHttpRequest;return path="player.txt",e.open("GET",path,!1),e.send(null),e.responseText}function getHelpFile(){var e=new XMLHttpRequest;return path="HelpText.txt",e.open("GET",path,!1),e.send(null),e.responseText}function getHelpIndex(){var e=new XMLHttpRequest;return path="HelpIndex.html",e.open("GET",path,!1),e.send(null),e.responseText}function displayHelp(e){var t=new XMLHttpRequest;t.open("GET",e,!1),t.send(null),document.getElementById("helpText").innerHTML="<pre>"(t.responseText)+"</pre>"}function chordLines(){for(var e=0,t=0;e<ARRlines.length;)"chord"==lineType(ARRlines[e])&&(t+=1),e++;return t}function isHeader(e){var t=!1,n=e.substring(0,5).toUpperCase();return"VERSE"==n|"#VERS"==n|"CHORU"==n|"#CHOR"==n|"BREAK"==n|"#BREA"==n|"INTRO"==n|"#INTR"==n|"OUTRO"==n|"#OUTR"==n|"#BRIDG"==n|"#BRID"==n|"#TURN "==n|"#TURN"==n&&(t=!0),t}function countChr(e,t){for(var n=0,o=0;n<e.length;)e[n]==t&&o++,n++;return o}function listChords(){var e=ARRlines,t="";for(j=0;j<e.length;)"chord"==lineType(e[j])&&(0!==TRANSPOSE&&(e[j]=lineTranspose(e[j],TRANSPOSE)),t+=e[j]),j++;return t=unique(e=(t=(t=(t=(e=(t=(e=(t=(e=(t=(e=(t=(e=(t=(e=(t=(e=(t=t.replace(/~/g," |")).split("*")).join("")).split("||")).join("@")).split("|%")).join("")).split("| ")).join("")).split("@")).join("|")).split("|NC")).join("")).split("^")).join("")).replace(/ /g,"")).substr(1)).split("|")).join(" - ")}function firstLineValues(e){BPM=120,BEATS=4,KEY="C","hash"==lineType(ARRlines[0])&&(TITLE=decodeURI(hash(ARRlines[0],"TITLE",TITLE)),DURtext=hash(ARRlines[0],"DUR",""),BPM=hash(ARRlines[0],"BPM",BPM),BEATS=hash(ARRlines[0],"BEATS",BEATS),0===(KEY=hash(ARRlines[0],"KEY",KEY))|"0"==KEY&&(KEY="C"),"Inwork"!==(QUAL=hash(ARRlines[0],"QUAL",QUAL))&"Verified"!==QUAL&"Complete"!==QUAL&&(QUAL="Raw"),"Inwork"==QUAL&&(STARS=2),STARS="Preliminary"==QUAL?3:"Verified"==QUAL?4:"Complete"==QUAL?5:1,GENRE=hash(ARRlines[0],"GENRE","Unknown"),STYLE=hash(ARRlines[0],"STYLE","Unknown"),HITyear=hash(ARRlines[0],"HITyear","Unknown"),ARTIST=hash(ARRlines[0],"ARTIST","Unknown"))}function setUpListener(){document.getElementById("fileinput").addEventListener("change",loadFile,!1)}function loadFile(e){readSingleFile(e),setTimeout(function(){createARRlines(RAWtune),document.getElementById("myTune").innerHTML=TITLE,barSelect()},2e3)}function readSingleFile(e){if(statusMsg("Reading file","yellow"),file=e.target.files[0],file){var t=new FileReader;t.onload=function(e){RAWtune=e.target.result,TITLE=file.name.substring(0,file.name.length-4)},t.readAsText(file)}else alert("No Valid File...")}function barSelect(e){"none"==e&&statusMsg("All toolbars closed");for(var t="configuration,information,tool,songBar2".split(","),n=0;n<t.length;)e==t[n]&"none"===document.getElementById(t[n]).style.display?(dis(t[n],"block"),statusMsg("The "+e.toUpperCase()+" BAR Opened...")):dis(t[n],"none"),n++}function triviaNotes(){return"<center>"+TITLE.toUpperCase()+"<br>ARTIST: "+ARTIST+" < > HIT YEAR; "+HITyear+"</center><br>"+NOTEtrivia}function playlistNotes(){return"<center>"+TITLE.toUpperCase()+"</center>@"+NOTEset}function clockRun(){if(!0===CLOCK){dis("clock","block");var e=new Date,t=e.getHours(),n="AM";11<t&&(n="PM"),12<t&&(t-=12);var o=e.getMinutes();o<10&&(o="0"+o),document.getElementById("clock").innerHTML="<X12>"+t+":"+o+n+"</X12>",TIMEOUTclock=setTimeout(function(){clockRun()},1e4)}else clearTimeout(TIMEOUTclock),dis("clock","none")}function printFormat(){for(var e="",t=0,n=parseInt(ARRlines.length-1,10);t<n;)e=e+"\n"+ARRlines[t],t++;return e}function portraitWarning(){window.innerHeight>=window.innerWidth&&alert("ROTATE YOUR DEVICE...")}function fileFromPath(e){return(e=e.split("/"))[e.length-1]}function statusMsg(e,t,n){null!==e&&""!==e&&" "!==e||(e="ERROR: No Status Message Passed"),0<STATUSmon&&(ARRstatusLog.length>LOG&&ARRstatusLog.pop(),0==t?ARRstatusLog.splice(0,0,stdTime("",!0)+"       <X8>"+e+"</X8>"):ARRstatusLog.splice(0,0,stdTime("",!0)+"  <X1>"+e+"</X1>")),1<STATUSmon&&(document.getElementById("bootText").innerHTML="<pre>"+ARRstatusLog.join("<br>")+"</pre>"),0!=t&&sm2(e,t,n)}function sm2(e,t,n){var o="black";null===e?e="*"+MSGlast:MSGlast=e,"block"==document.getElementById("splash").style.display?t="transparent":"black"==t|"red"==t|"green"==t|"blue"==t|"grey"==t?o="white":"yellow"==t?o="red":t="lightgrey",!0===n&&(e="<marquee><mark>"+e+"</mark></marquee>",t="yellow"),document.getElementById("msg").style.color=o,document.getElementById("msg").style.backgroundColor=t,document.getElementById("msg").innerHTML=e}function secToMin(e){var t=parseInt(e/60,10),n=parseInt(60*parseFloat(e/60-parseInt(e/60,10)),10);return t+(n=n<10?":0"+n:":"+n)}function hash(e,t,n){for(var o=e.split(","),s=0;s<o.length;){var l=o[s].split(":");l[0]==t&&(n=l[1],s=o.length),s++}return n}function dis(e,t){void 0===t?document.getElementById(e).style.display==NONE?document.getElementById(e).style.display="block":document.getElementById(e).style.display=NONE:document.getElementById(e).style.display="none"==t?NONE:"block"}function zin(e,t){document.getElementById(e).style.zIndex=t}function vis(e,t){void 0===t&&(t="visible"==document.getElementById(e).style.visibility?"hidden":"visible"),document.getElementById(e).style.visibility=t}function receiveARR(e,t){var n,o=window.name;return n=void 0===e?decodeURIComponent(decodeFredComponent(window.name)):decodeURIComponent(decodeFredComponent(window.name)).split(e),!0===t|void 0===t|""===t&&(window.name=o),n}function passARR(e,t,n,o){var s;s=!0===Array.isArray(t)?t.join(n):t,null!==o&&(s=o+n+s),window.open(e,encodeURI(encodeFredComponent(s)),"toolbar=yes,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes"),dis("prntType","none")}function encodeFredComponent(e){return e=(e=(e=(e=e.split("?")).join("QMARK")).split("@")).join("AMARK")}function decodeFredComponent(e){return e=(e=(e=(e=e.split("QMARK")).join("?")).split("AMARK")).join("@")}function lineType(e){var t="lyric";return"IREALB:"==e.substring(0,7).toUpperCase()?t="irealb":"http"==e.substring(0,4)?t="link":"@@@"==e.substring(0,3)?t="noteTech":"@@"==e.substring(0,2)?t="noteTriv":"@"==e.substring(0,1)?t="note":"#"==e.substring(0,1)?t="header":"$"==e.substring(0,1)?t="spacer":-1<e.search(":")?t="hash":-1<e.indexOf("|")&&(t="chord"),t}function longestLine(){for(var e=0,t=0;t<ARRlines.length;){var n=lineType(ARRlines[t]);"lyric"==n|"chord"==n&&ARRlines[t].length>e&&(e=ARRlines[t].length),t++}return e}function stdTime(e,t){var n=0,o=0,s=0,l="AM";if(!(null===e|void 0===e|""===e|" "===e))return e;var i=new Date;return o=i.getHours(),s=i.getMinutes(),n=i.getSeconds(),11<o&&(l="PM"),12<o&&(o-=12),s<10&&(s="0"+s),!0===t&&(n<10&&(n="0"+n),s=s+":"+n),o+":"+s+l}function barsClear(){for(i=0;i<ARRbars.length;i++){var e="b"+i;document.getElementById(e).style.backgroundColor="transparent"}statusMsg("ALL BARS: "+BARS+" cleared..",0)}function statusMonitor(e){var t="";0===e&&(t="<X2>Debug Log Deactivated==================</X2>",document.getElementById("imgDebug").src="../../Icons/off.png",dis("statusWindow","none"),dis("bug","none")),1===e?(dis("statusWindow","none"),document.getElementById("imgDebug").src="../../Icons/bugButton.jpg",dis("bug","block"),t="<X2>Debug Log Active and Hidden============</X2>"):2===e&&(document.getElementById("imgDebug").src="../../Icons/bugButton.jpg",dis("statusWindow","block"),dis("bug","block"),t="<X2>Debug Log Active and Displayed=========</X2>"),STATUSmon=e,statusMsg(t,0)}function monitorWindow(){dis("statusWindow"),"block"===document.getElementById("statusWindow").style.display?(statusMonitor(2),document.getElementById("bootText").innerHTML="<pre>"+ARRstatusLog.join("<br>")+"</pre>"):statusMonitor(1)}function setMonitor(){statusMonitor(0===STATUSmon?2:0)}function debugResize(){for(arr="20%,40%,60%,80%,20%".split(","),n=0;n<5;n++)document.getElementById("statusWindow").style.width<=arr[n]&&(document.getElementById("statusWindow").style.width=arr[n+1],document.getElementById("bug").style.left=arr[n+1],n=5)}function bugButton(e){var t="";"Scroll"===e&&(t=(t=(t=(t=(t="BPM: "+BPM+"  BARS:"+ARRbars.length+" ("+BARShalf+" half bars)\nMEASURES: "+MEASURES+" at "+BEATS+" beats per Measure = "+BEATS*MEASURES)+" Total Beats\nDUR: "+DUR+" seconds  Duration Source: "+DURsource+"\n")+"Scroll Time: "+parseInt(1e6*document.getElementById("Tune").scrollTop/SCROLLpix,10)/1e4)+"%  Scroll Top: "+document.getElementById("Tune").scrollTop+" of "+SCROLLpix+"\n")+"Track  Time: "+parseInt(1e6*document.getElementById("Audio1").currentTime/DURmp3,10)/1e4+"%  Current Seconds: "+document.getElementById("Audio1").currentTime+" of "+document.getElementById("Audio1").duration+" "),"ARRbars"===e&&(t=ARRbars.join(",")),t=e+"----------\n"+t+"\n"+e+"^^^^^^^^^^^^^^\n",document.getElementById("devText").innerHTML=t,dis("devText","block")}function sleep(e){statusMsg("<X2>SLEEPING for "+e+"milliseconds</X2>");for(var t=(new Date).getTime();t+e>=(new Date).getTime(););}function badCode(){alert(parseInt(1/0,10))}function bogus(){flash("QUALITY: "+QUAL,3),blinker("msg",5)}function countBARS(){ARRbars.length=0;for(var e,t=BARSperLine=BARShalf=BARS=0,n=0,o=0,s=0;o<ARRlines.length;){var l=ARRlines[o];if("chord"==lineType(l))for(t+=1,s=0;s<l.length;s++)"|"===l.charAt(s)&&(e=1,"*"===l.charAt(s+1)&&(e=.5,BARShalf+=1),n+=e,ARRbars.push(n),BARS+=1);o+=1}0<t&&(BARSperLine=BARS/t),statusMsg("MEASURES: "+(MEASURES=BARS-.5*BARShalf)+" / BARS:"+BARS+" (Full:"+parseInt(BARS-BARShalf)+" & HALF:"+BARShalf+") CHORD LINES: "+t+"   BARS/LINE: "+BARSperLine,0)}function rollMirror(e){clearTimeout(TIMEOUTmirror),!0===e&&(MIRROR<3?(document.getElementById("mirror").style.color="black",document.getElementById("mirrorImage").src=1===MIRROR?(document.getElementById("mirror").innerHTML=BPM,"../../Icons/transCircleGreen.png"):2===MIRROR?(document.getElementById("mirror").innerHTML=KEY,"../../Icons/transCircleYellow.png"):(document.getElementById("mirror").innerHTML=STARS,"../../Icons/transCircleStar.png"),MIRROR++):(MIRROR=0,document.getElementById("mirrorImage").src="../../Icons/"+SOUNDicon,document.getElementById("mirror").style.color="transparent"),TIMEOUTmirror=setTimeout(function(){rollMirror(!0)},2e3))}function setLineLimit(e){void 0===e?LINElimit-=5:LINElimit=e,LINElimit<=25&&(LINElimit=90),document.getElementById("lineLimit").innerHTML=LINElimit}function breakLine(e){for(var t,n="",o="",s=200,l=10;l<s;)s=e.length,l=(e=e.split("  ").join(" ")).length;if(e.length<=LINElimit)n=e;else{for(t=parseInt(.5*l,10)-2;" "!==e.substring(t-1,t);)t-=1;n=e.substring(0,t);var i=LINElimit-e.substring(t,e.length).length;for(k=1;k<i-2;k++)o+=" ";n=n+"<br>"+o+e.substring(t,e.length)}return n}function opacSet(e,t){void 0===t|null===t|1<t&&(t=1),document.getElementById(e).style.opacity=t}window.onload=function(){document.getElementById("statusWindow").style.display="none",ARRstatusLog="<pre>========================BROWSER LOADING THIS PAGE=================</pre>".split("-"),STATUSmon=1,statusMsg("PRESS ANY KEY or CLICK THE 'BUG' to monitor the boot..."),BOOT=!0,document.getElementById("debugTrigger").focus(),TIMEOUTcrap=setTimeout(function(){start()},1500)};